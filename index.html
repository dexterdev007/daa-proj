<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NP-Completeness Learning Platform</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.26.0/cytoscape.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Source+Code+Pro:wght@500;700&display=swap" rel="stylesheet">
    <style>
        /* Dark/Light Mode Variables */
        :root {
            --bg-dark: #0a0f1f;
            --bg-card: #1e293b;
            --text-main: #E5E7EB;
            --text-secondary: #9CA3AF;
            --border-color: #374151;
            --primary-blue: #3B82F6;
            --primary-indigo: #8b5cf6;
            --code-bg: #111827;
        }

        .light {
            --bg-dark: #f8fafc;
            --bg-card: #ffffff;
            --text-main: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --primary-blue: #2563eb;
            --primary-indigo: #6366f1;
            --code-bg: #f1f5f9;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1f3f 100%);
            color: var(--text-main);
            transition: all 0.3s;
        }

        .light body {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        .font-mono-code {
            font-family: 'Source Code Pro', monospace;
        }

        /* Pseudo code visualization panel */
        .pseudo-code-panel {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            width: 350px;
            max-height: 70vh;
            background: var(--bg-card);
            border: 2px solid var(--primary-indigo);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 10px 40px rgba(139, 92, 246, 0.3);
            z-index: 1000;
            overflow-y: auto;
            opacity: 0;
            transform: translateY(-50%) translateX(400px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .pseudo-code-panel.visible {
            opacity: 1;
            transform: translateY(-50%) translateX(0);
        }
        
        .pseudo-code-panel h3 {
            color: var(--primary-indigo);
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .pseudo-code-panel .close-btn {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.5rem;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s;
        }
        
        .pseudo-code-panel .close-btn:hover {
            color: var(--text-main);
        }
        
        .pseudo-code-step {
            margin-bottom: 1rem;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
            background: var(--code-bg);
        }
        
        .pseudo-code-step.active {
            border-left-color: var(--primary-indigo);
            background: rgba(139, 92, 246, 0.1);
            transform: translateX(5px);
        }
        
        .pseudo-code-step.completed {
            border-left-color: #10b981;
            opacity: 0.7;
        }
        
        .pseudo-code-step .step-number {
            display: inline-block;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--border-color);
            color: var(--text-secondary);
            text-align: center;
            line-height: 24px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }
        
        .pseudo-code-step.active .step-number {
            background: var(--primary-indigo);
            color: white;
        }
        
        .pseudo-code-step.completed .step-number {
            background: #10b981;
            color: white;
        }
        
        .pseudo-code-step .step-code {
            font-family: 'Source Code Pro', monospace;
            font-size: 0.875rem;
            color: var(--text-main);
            margin-top: 0.5rem;
            padding: 0.75rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0.375rem;
            white-space: pre-wrap;
            word-break: break-word;
            line-height: 1.6;
            overflow-x: auto;
        }
        
        .pseudo-code-panel::-webkit-scrollbar {
            width: 6px;
        }
        
        .pseudo-code-panel::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }
        
        .pseudo-code-panel::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }
        
        .pseudo-code-panel::-webkit-scrollbar-thumb:hover {
            background: var(--primary-indigo);
        }
        
        .pseudo-code-step .step-description {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }
        
        .pseudo-code-toggle {
            position: fixed;
            right: 2rem;
            bottom: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-indigo);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .pseudo-code-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.6);
        }
        
        /* Responsive pseudo code panel */
        @media (max-width: 1024px) {
            .pseudo-code-panel {
                width: 300px;
                right: 1rem;
            }
        }
        
        @media (max-width: 768px) {
            .pseudo-code-panel {
                width: calc(100% - 2rem);
                right: 1rem;
                left: 1rem;
                max-height: 60vh;
                top: auto;
                bottom: 80px;
                transform: translateY(0) translateX(0);
            }
            
            .pseudo-code-panel.visible {
                transform: translateY(0) translateX(0);
            }
            
            .pseudo-code-toggle {
                bottom: 1rem;
                right: 1rem;
            }
        }

        /* Enhanced step indicators */
        .step-progress-bar {
            position: absolute;
            left: 15px;
            top: 30px;
            bottom: -20px;
            width: 2px;
            background: var(--border-color);
            z-index: 1;
        }

        .step-progress-fill {
            position: absolute;
            left: 15px;
            top: 30px;
            width: 2px;
            background: var(--primary-indigo);
            z-index: 2;
            transition: height 0.5s ease;
        }

        /* Animated step explanations */
        .step-explanation {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .step-explanation.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .step-explanation.highlight {
            background: rgba(139, 92, 246, 0.1);
            border-left: 4px solid var(--primary-indigo);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.5rem;
        }

        /* Animated cards */
        .concept-card {
            opacity: 0;
            transform: scale(0.95);
            transition: all 0.4s ease;
        }

        .concept-card.visible {
            opacity: 1;
            transform: scale(1);
        }

        .concept-card:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.15);
        }

        /* Step navigation controls */
        .step-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin: 2rem 0;
            padding: 1rem;
            background: var(--bg-card);
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
        }

        .step-indicator-dots {
            display: flex;
            gap: 0.5rem;
        }

        .step-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border-color);
            transition: all 0.3s ease;
        }

        .step-dot.active {
            background: var(--primary-indigo);
            transform: scale(1.2);
        }

        .step-dot.completed {
            background: #10b981;
        }

        /* Floating hints */
        .hint-tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .hint-tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--bg-card);
            color: var(--text-main);
            text-align: left;
            border-radius: 6px;
            padding: 0.5rem;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid var(--border-color);
            font-size: 0.875rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .hint-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* Learning assistant */
        .learning-assistant {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: var(--primary-indigo);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .learning-assistant:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .assistant-panel {
            position: fixed;
            bottom: 6rem;
            right: 2rem;
            width: 320px;
            max-height: 400px;
            background: var(--bg-card);
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            padding: 1rem;
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            transition: all 0.3s ease;
            z-index: 999;
            overflow-y: auto;
        }

        .assistant-panel.visible {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        /* Navigation Stepper */
        .nav-stepper {
            position: fixed;
            left: 0;
            top: 0;
            width: 300px;
            height: 100vh;
            background: var(--bg-card);
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
            overflow-x: hidden;
            z-index: 40;
            transition: transform 0.3s ease;
            padding-top: 70px; /* Add space for hamburger button */
        }
        
        .nav-stepper .p-6 {
            padding: 1.5rem;
        }
        
        .nav-stepper h2 {
            color: var(--text-main) !important;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            padding: 0 0.5rem;
        }
        
        .nav-stepper::-webkit-scrollbar {
            width: 6px;
        }
        
        .nav-stepper::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }
        
        .nav-stepper::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }
        
        .nav-stepper::-webkit-scrollbar-thumb:hover {
            background: var(--primary-indigo);
        }
        
        /* Adjust header position inside sidebar */
        .nav-stepper > div:first-child {
            margin-top: -50px;
        }

        .nav-stepper.mobile-hidden {
            transform: translateX(-100%);
        }

        .nav-item {
            display: flex;
            align-items: flex-start;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid transparent;
            position: relative;
            overflow: visible;
            word-wrap: break-word;
            min-height: 60px;
        }
        
        .nav-item .flex-1 {
            flex: 1;
            min-width: 0;
            overflow: visible;
        }
        
        .nav-item .font-semibold {
            color: var(--text-main) !important;
            font-weight: 600;
            margin-bottom: 0.25rem;
            line-height: 1.4;
            word-break: break-word;
        }
        
        .nav-item .text-sm {
            color: var(--text-secondary) !important;
            font-size: 0.875rem;
            line-height: 1.3;
            word-break: break-word;
            display: block;
        }

        .nav-item:hover {
            background: rgba(139, 92, 246, 0.1);
            border-left-color: var(--primary-indigo);
        }

        .nav-item.active {
            background: rgba(139, 92, 246, 0.2);
            border-left-color: var(--primary-indigo);
        }

        .nav-number {
            width: 32px;
            height: 32px;
            min-width: 32px;
            border-radius: 50%;
            background: var(--border-color);
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
            margin-right: 1rem;
            margin-top: 0.125rem;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number {
            background: var(--primary-indigo);
            color: white;
        }

        /* Main Content */
        .main-content {
            margin-left: 300px;
            min-height: 100vh;
            transition: margin-left 0.3s ease;
            background: var(--bg-dark);
        }

        .main-content.full-width {
            margin-left: 0;
        }

        /* Mobile Toggle */
        .mobile-nav-toggle {
            display: none;
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            z-index: 50;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--primary-indigo);
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }
        
        /* Hamburger Menu Toggle */
        .hamburger-toggle {
            display: block; /* Always visible for sidebar toggle */
            position: fixed;
            top: 1rem;
            left: 1rem; /* Back to left side for intuitive sidebar control */
            z-index: 100; /* Ensure above sidebar */
            width: 48px;
            height: 48px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            opacity: 0.9;
        }
        
        .hamburger-toggle:hover {
            opacity: 1;
            background: var(--primary-indigo);
            border-color: var(--primary-indigo);
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .hamburger-toggle:hover .hamburger-line {
            background: white;
        }
        
        .hamburger-line {
            display: block;
            width: 24px;
            height: 2px;
            background: var(--text-main);
            border-radius: 1px;
            transition: all 0.3s ease;
            margin: 4px 0;
        }
        
        .hamburger-toggle.active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        
        .hamburger-toggle.active .hamburger-line:nth-child(2) {
            opacity: 0;
        }
        
        .hamburger-toggle.active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        /* Desktop styles - keep hamburger for sidebar toggle */
        @media (min-width: 769px) {
            .nav-stepper {
                transform: translateX(0);
                transition: transform 0.3s ease;
            }
            
            .nav-stepper.mobile-hidden {
                transform: translateX(-100%);
            }
        }
        
        @media (max-width: 768px) {
            .nav-stepper {
                width: 100%;
                height: auto;
                position: fixed;
                bottom: 0;
                top: auto;
                max-height: 50vh;
                background: var(--bg-secondary);
                border-top: 1px solid var(--border-color);
                z-index: 40;
                transform: translateY(0);
                transition: transform 0.3s ease;
            }
            
            .nav-stepper.mobile-hidden {
                transform: translateY(100%);
            }
            
            .main-content {
                margin-left: 0;
                padding-bottom: 6rem;
            }
            
            .nav-items {
                flex-direction: row;
                overflow-x: auto;
                gap: 0.5rem;
                padding: 1rem;
            }
            
            .nav-item {
                flex-shrink: 0;
                min-width: 60px;
                padding: 0.5rem;
                font-size: 0.75rem;
                flex-direction: column;
                text-align: center;
            }
            
            .nav-item .step-number {
                font-size: 0.875rem;
                width: 24px;
                height: 24px;
            }
            
            .nav-item .step-name {
                display: none;
            }
            
            .content-section {
                padding: 2rem 1rem;
                min-height: 100vh;
            }
            
            .card {
                padding: 1rem;
                margin: 0.5rem 0;
            }
            
            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }
            
            .modal-content {
                margin: 1rem;
                padding: 1.5rem;
                max-height: 90vh;
            }
            
            .mobile-nav-toggle {
                display: block;
            }
            
            /* Stack grid on mobile */
            .grid {
                grid-template-columns: 1fr;
            }
            
            /* Adjust text sizes */
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
            h3 { font-size: 1.25rem; }
            
            /* Fix overflow issues */
            .formula-display {
                font-size: 0.875rem;
                word-break: break-all;
            }
            
            .truth-table {
                font-size: 0.75rem;
                overflow-x: auto;
            }
        }
        
        @media (max-width: 480px) {
            .card {
                padding: 0.75rem;
            }
            
            .btn {
                padding: 0.375rem 0.75rem;
                font-size: 0.8rem;
            }
            
            .formula-display {
                font-size: 0.75rem;
            }
            
            .code-display {
                font-size: 0.75rem;
                padding: 0.5rem;
            }
            
            h1 { font-size: 1.75rem; }
            h2 { font-size: 1.375rem; }
        }
        
        /* Tablet adjustments */
        @media (min-width: 769px) and (max-width: 1024px) {
            .nav-items {
                gap: 0.75rem;
            }
            
            .nav-item {
                padding: 0.75rem;
            }
            
            .card {
                padding: 1.5rem;
            }
        }
        
        /* Large screens */
        @media (min-width: 1200px) {
            .container {
                max-width: 1200px;
            }
        }

        /* Content Sections */
        .content-section {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards and Components */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover.btn:active {
            transform: scale(0.98);
        }
        
        /* Toggle Button Styles */
        .toggle-btn {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .toggle-btn[data-state="on"] {
            background: var(--primary-indigo);
            color: white;
            border-color: var(--primary-indigo);
        }
        
        .toggle-btn[data-state="off"] {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border-color: var(--border-color);
        }
        
        .toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .toggle-btn::after {
            content: '';
            position: absolute;
            top: 2px;
            right: 2px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success-green);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .toggle-btn[data-state="on"]::after {
            opacity: 1;
        }
        
        /* Code Display */
        .code-display {
            background: var(--code-bg);
            border: 1px solid var(--border-color);
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: 'Source Code Pro', monospace;
            overflow-x: auto;
        }
        
        /* Expression Builder Styles */
        .clause-builder {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            position: relative;
        }
        
        .clause-builder select,
        .clause-builder input {
            background: var(--code-bg);
            border: 1px solid var(--border-color);
            color: var(--text-main);
            padding: 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }
        
        .clause-builder select:focus,
        .clause-builder input:focus {
            outline: none;
            border-color: var(--primary-indigo);
            box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.2);
        }
        
        .literal-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: var(--code-bg);
            border-radius: 0.375rem;
        }
        
        .remove-clause-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .remove-clause-btn:hover {
            background: #ef4444;
            color: white;
        }
        
        .add-literal-btn {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            background: rgba(139, 92, 246, 0.1);
            color: var(--primary-indigo);
            border: 1px solid var(--primary-indigo);
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .add-literal-btn:hover {
            background: var(--primary-indigo);
            color: white;
        }

        /* Buttons */
        .btn-primary {
            background: var(--primary-indigo);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary:hover {
            background: #7c3aed;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--border-color);
            color: var(--text-main);
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        /* Graph Container */
        #clique-graph-container {
            background: var(--code-bg);
            border: 2px solid var(--primary-indigo);
            border-radius: 0.75rem;
            height: 500px;
            position: relative;
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-indigo), var(--primary-blue));
            transition: width 0.3s ease;
        }

        /* Animations */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Collapsible Content */
        .collapsible {
            cursor: pointer;
            user-select: none;
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .collapsible-content.expanded {
            max-height: 1000px;
        }

        /* Quiz Styles */
        .quiz-option {
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.75rem;
        }

        .quiz-option:hover {
            border-color: var(--primary-indigo);
            background: rgba(139, 92, 246, 0.05);
        }

        .quiz-option.selected {
            border-color: var(--primary-indigo);
            background: rgba(139, 92, 246, 0.1);
        }

        .quiz-option.correct {
            border-color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .quiz-option.incorrect {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        /* Print Styles */
        @media print {
            .nav-stepper, .mobile-nav-toggle, .no-print {
                display: none !important;
            }
            
            .main-content {
                margin-left: 0 !important;
            }
            
            body {
                background: white !important;
                color: black !important;
            }
            
            .card {
                border: 1px solid #ccc !important;
                break-inside: avoid;
            }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus Styles */
        *:focus {
            outline: 2px solid var(--primary-indigo);
            outline-offset: 2px;
        }

        /* Loading Spinner */
        .spinner {
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--primary-indigo);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Hamburger Menu Toggle -->
    <button class="hamburger-toggle" id="hamburger-toggle" aria-label="Toggle navigation menu">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
    </button>

    <!-- Learning Assistant -->
    <div class="learning-assistant" id="learning-assistant">
        <span style="color: white; font-size: 24px;">ü§ñ</span>
    </div>
    
    <div class="assistant-panel" id="assistant-panel">
        <h3 class="font-semibold mb-3" style="color: var(--text-main);">Learning Assistant</h3>
        <div id="assistant-content">
            <p style="color: var(--text-secondary); font-size: 0.875rem;">
                Hi! I'm here to help you understand NP-Completeness. Click on any section to get personalized hints and explanations.
            </p>
        </div>
        <div class="mt-4 space-y-2">
            <button class="btn-secondary w-full text-sm" id="assistant-hint-btn">
                üí° Get Hint
            </button>
            <button class="btn-secondary w-full text-sm" id="assistant-explain-btn">
                üìö Explain Concept
            </button>
            <button class="btn-secondary w-full text-sm" id="assistant-next-btn">
                ‚û°Ô∏è Next Step
            </button>
        </div>
    </div>

    <!-- Pseudo Code Visualization Panel -->
    <div class="pseudo-code-panel" id="pseudo-code-panel">
        <h3>
            <span>Algorithm Steps</span>
            <button class="close-btn" id="pseudo-code-close">√ó</button>
        </h3>
        <div id="pseudo-code-content"></div>
    </div>

    <!-- Pseudo Code Toggle Button -->
    <button class="pseudo-code-toggle" id="pseudo-code-toggle" title="Show Algorithm Steps">
        üìù
    </button>

    <!-- Navigation Stepper -->
    <nav class="nav-stepper mobile-hidden" id="nav-stepper" role="navigation" aria-label="Learning path">
        <div class="p-6">
            <h2 class="text-xl font-bold mb-6" style="color: var(--text-main);">
                Learning Path
            </h2>
            <!-- Progress bar container -->
            <div class="step-progress-bar"></div>
            <div class="step-progress-fill" id="step-progress-fill" style="height: 0%;"></div>
            <div class="space-y-2">
                <div class="nav-item active" data-section="overview" tabindex="0" role="button">
                    <div class="nav-number">1</div>
                    <div class="flex-1">
                        <div class="font-semibold" style="color: var(--text-main);">Overview</div>
                        <div class="text-sm" style="color: var(--text-secondary);">Introduction to NP-Completeness</div>
                    </div>
                </div>
                <div class="nav-item" data-section="theory" tabindex="0" role="button">
                    <div class="nav-number">2</div>
                    <div class="flex-1">
                        <div class="font-semibold" style="color: var(--text-main);">Theory</div>
                        <div class="text-sm" style="color: var(--text-secondary);">P vs NP, reductions</div>
                    </div>
                </div>
                <div class="nav-item" data-section="sat" tabindex="0" role="button">
                    <div class="nav-number">3</div>
                    <div class="flex-1">
                        <div class="font-semibold" style="color: var(--text-main);">SAT Solver</div>
                        <div class="text-sm" style="color: var(--text-secondary);">Boolean satisfiability</div>
                    </div>
                </div>
                <div class="nav-item" data-section="3cnf" tabindex="0" role="button">
                    <div class="nav-number">4</div>
                    <div class="flex-1">
                        <div class="font-semibold" style="color: var(--text-main);">3-CNF</div>
                        <div class="text-sm" style="color: var(--text-secondary);">Convert to 3-CNF form</div>
                    </div>
                </div>
                <div class="nav-item" data-section="reduction" tabindex="0" role="button">
                    <div class="nav-number">5</div>
                    <div class="flex-1">
                        <div class="font-semibold" style="color: var(--text-main);">Reduction</div>
                        <div class="text-sm" style="color: var(--text-secondary);">3-SAT ‚Üí CLIQUE</div>
                    </div>
                </div>
                <div class="nav-item" data-section="visualizer" tabindex="0" role="button">
                    <div class="nav-number">6</div>
                    <div class="flex-1">
                        <div class="font-semibold" style="color: var(--text-main);">Visualizer</div>
                        <div class="text-sm" style="color: var(--text-secondary);">Interactive graph</div>
                    </div>
                </div>
                <div class="nav-item" data-section="practice" tabindex="0" role="button">
                    <div class="nav-number">7</div>
                    <div class="flex-1">
                        <div class="font-semibold" style="color: var(--text-main);">Practice</div>
                        <div class="text-sm" style="color: var(--text-secondary);">Problems & hints</div>
                    </div>
                </div>
                <div class="nav-item" data-section="quiz" tabindex="0" role="button">
                    <div class="nav-number">8</div>
                    <div class="flex-1">
                        <div class="font-semibold" style="color: var(--text-main);">Quiz</div>
                        <div class="text-sm" style="color: var(--text-secondary);">Test your knowledge</div>
                    </div>
                </div>
                <div class="nav-item" data-section="glossary" tabindex="0" role="button">
                    <div class="nav-number">9</div>
                    <div class="flex-1">
                        <div class="font-semibold" style="color: var(--text-main);">Glossary</div>
                        <div class="text-sm" style="color: var(--text-secondary);">Terms & examples</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="p-6 border-t" style="border-color: var(--border-color);">
            <h3 class="text-sm font-semibold mb-3" style="color: var(--text-secondary);">Quick Actions</h3>
            <div class="space-y-2">
                <button class="btn-secondary w-full text-sm" id="cheat-sheet-btn">
                    üìã Cheat Sheet
                </button>
                <button class="btn-secondary w-full text-sm" id="notes-btn">
                    üìù Teacher Notes
                </button>
                <button class="btn-secondary w-full text-sm" id="dark-mode-toggle">
                    üåì Dark/Light Mode
                </button>
                <button class="btn-secondary w-full text-sm" id="dev-panel-btn">
                    ‚öôÔ∏è Dev Panel
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="main-content" id="main-content">
        <div class="max-w-6xl mx-auto p-6">
                    <!-- Section 1: Overview -->
            <section class="content-section active" id="overview">
                <div class="text-center py-12">
                    <h1 class="text-5xl font-bold mb-4" style="color: var(--text-main);">
                        NP-Completeness Learning Platform
                    </h1>
                    <p class="text-xl mb-8" style="color: var(--text-secondary);">
                        Master computational complexity through interactive visualizations and guided learning
                    </p>
                    
                    <!-- Progress Overview -->
                    <div class="card max-w-2xl mx-auto">
                        <h3 class="text-lg font-semibold mb-4" style="color: var(--text-main);">Your Progress</h3>
                        <div class="progress-bar mb-2">
                            <div class="progress-fill" id="overall-progress" style="width: 0%;"></div>
                        </div>
                        <p class="text-sm" style="color: var(--text-secondary);">
                            <span id="progress-text">0%</span> Complete ‚Ä¢ 
                            <span id="sections-completed">0</span>/9 sections
                        </p>
                    </div>

                    <!-- Feature Cards -->
                    <div class="grid md:grid-cols-3 gap-6 mt-12">
                        <div class="concept-card card card-hover text-left" data-step="1">
                            <div class="text-4xl mb-3">üí°</div>
                            <h3 class="text-xl font-bold mb-2" style="color: var(--text-main);">
                                Learn Theory
                                <span class="hint-tooltip">‚ÑπÔ∏è
                                    <span class="tooltip-text">
                                        Start with the fundamental concepts of computational complexity theory
                                    </span>
                                </span>
                            </h3>
                            <p style="color: var(--text-secondary);">
                                Understand P vs NP, polynomial-time reductions, and completeness proofs with interactive explanations.
                            </p>
                            <div class="step-explanation mt-4">
                                <h4 class="font-semibold mb-2" style="color: var(--primary-indigo);">What you'll learn:</h4>
                                <ul class="text-sm space-y-1" style="color: var(--text-secondary);">
                                    <li>‚Ä¢ Definition of P and NP classes</li>
                                    <li>‚Ä¢ Polynomial-time reductions</li>
                                    <li>‚Ä¢ NP-completeness proof techniques</li>
                                </ul>
                            </div>
                        </div>
                        <div class="concept-card card card-hover text-left" data-step="2">
                            <div class="text-4xl mb-3">üîÑ</div>
                            <h3 class="text-xl font-bold mb-2" style="color: var(--text-main);">
                                Visualize Reductions
                                <span class="hint-tooltip">‚ÑπÔ∏è
                                    <span class="tooltip-text">
                                        See how problems transform into each other through step-by-step animations
                                    </span>
                                </span>
                            </h3>
                            <p style="color: var(--text-secondary);">
                                Watch SAT formulas transform step-by-step into CLIQUE problems with animated visualizations.
                            </p>
                            <div class="step-explanation mt-4">
                                <h4 class="font-semibold mb-2" style="color: var(--primary-indigo);">Interactive features:</h4>
                                <ul class="text-sm space-y-1" style="color: var(--text-secondary);">
                                    <li>‚Ä¢ Step-by-step 3-SAT to 3-CNF conversion</li>
                                    <li>‚Ä¢ Graph construction visualizations</li>
                                    <li>‚Ä¢ Real-time reduction animations</li>
                                </ul>
                            </div>
                        </div>
                        <div class="concept-card card card-hover text-left" data-step="3">
                            <div class="text-4xl mb-3">üéØ</div>
                            <h3 class="text-xl font-bold mb-2" style="color: var(--text-main);">
                                Practice & Quiz
                                <span class="hint-tooltip">‚ÑπÔ∏è
                                    <span class="tooltip-text">
                                        Test your understanding with hands-on problems and assessments
                                    </span>
                                </span>
                            </h3>
                            <p style="color: var(--text-secondary);">
                                Solve graded problems, take quizzes, and track your learning progress with instant feedback.
                            </p>
                            <div class="step-explanation mt-4">
                                <h4 class="font-semibold mb-2" style="color: var(--primary-indigo);">Practice includes:</h4>
                                <ul class="text-sm space-y-1" style="color: var(--text-secondary);">
                                    <li>‚Ä¢ Graded problem sets with hints</li>
                                    <li>‚Ä¢ Interactive quiz questions</li>
                                    <li>‚Ä¢ Progress tracking and feedback</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Start -->
                    <div class="card max-w-2xl mx-auto mt-8">
                        <h3 class="text-lg font-semibold mb-4" style="color: var(--text-main);">üöÄ Quick Start</h3>
                        <p class="mb-4" style="color: var(--text-secondary);">
                            Try our interactive visualizer with a sample formula, or navigate through the learning path step by step.
                        </p>
                        <div class="flex flex-col sm:flex-row gap-4 justify-center">
                            <button class="btn-primary" id="quick-visualize-btn">
                                Try Visualizer
                            </button>
                            <button class="btn-secondary" id="start-learning-btn">
                                Start Learning Path
                            </button>
                        </div>
                    </div>

                    <!-- Keyboard Shortcuts -->
                    <div class="card max-w-2xl mx-auto mt-6">
                        <h3 class="text-lg font-semibold mb-3" style="color: var(--text-main);">‚å®Ô∏è Keyboard Shortcuts</h3>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div><kbd class="px-2 py-1 bg-gray-700 rounded">N</kbd> Next section</div>
                            <div><kbd class="px-2 py-1 bg-gray-700 rounded">P</kbd> Previous section</div>
                            <div><kbd class="px-2 py-1 bg-gray-700 rounded">V</kbd> Visualizer</div>
                            <div><kbd class="px-2 py-1 bg-gray-700 rounded">H</kbd> Hint</div>
                        </div>
                    </div>
                </div>
            </section>

    <!-- Section 2: Theory -->
            <section class="content-section" id="theory">
                <div class="py-8">
                    <h2 class="text-4xl font-bold mb-6" style="color: var(--text-main);">Theory & Foundations</h2>
                    
                    <!-- P vs NP -->
                    <div class="card">
                        <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-indigo);">P vs NP Problem</h3>
                        <p class="mb-4" style="color: var(--text-secondary);">
                            The most important open question in computer science asks whether every problem whose solution can be quickly verified can also be quickly solved.
                        </p>
                        
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="p-4 rounded-lg" style="background: var(--code-bg);">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">P (Polynomial Time)</h4>
                                <p class="text-sm" style="color: var(--text-secondary);">
                                    Problems that can be solved in polynomial time by a deterministic Turing machine. 
                                    Examples: sorting, shortest path, maximum flow.
                                </p>
                            </div>
                            <div class="p-4 rounded-lg" style="background: var(--code-bg);">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">NP (Nondeterministic Polynomial Time)</h4>
                                <p class="text-sm" style="color: var(--text-secondary);">
                                    Problems where a solution can be verified in polynomial time, even if finding the solution might be hard.
                                    Examples: SAT, clique, Hamiltonian cycle.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- NP-Hard and NP-Complete -->
                    <div class="card">
                        <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-indigo);">NP-Hard & NP-Complete</h3>
                        
                        <div class="collapsible mb-4" id="np-hard-toggle">
                            <h4 class="font-semibold cursor-pointer flex items-center" style="color: var(--text-main);">
                                <span class="mr-2">‚ñº</span> NP-Hard Problems
                            </h4>
                        </div>
                        <div class="collapsible-content" id="np-hard-content">
                            <div class="p-4 rounded-lg mb-4" style="background: var(--code-bg);">
                                <p class="mb-3" style="color: var(--text-secondary);">
                                    A problem H is NP-hard if every problem L in NP can be reduced to H in polynomial time.
                                </p>
                                <ul class="list-disc pl-6 text-sm" style="color: var(--text-secondary);">
                                    <li>NP-hard problems are at least as hard as the hardest problems in NP</li>
                                    <li>They don't have to be in NP themselves</li>
                                    <li>Example: Halting problem is NP-hard but not in NP</li>
                                </ul>
                            </div>
                        </div>

                        <div class="collapsible mb-4" id="np-complete-toggle">
                            <h4 class="font-semibold cursor-pointer flex items-center" style="color: var(--text-main);">
                                <span class="mr-2">‚ñº</span> NP-Complete Problems
                            </h4>
                        </div>
                        <div class="collapsible-content" id="np-complete-content">
                            <div class="p-4 rounded-lg mb-4" style="background: var(--code-bg);">
                                <p class="mb-3" style="color: var(--text-secondary);">
                                    A problem C is NP-complete if:
                                </p>
                                <ol class="list-decimal pl-6 text-sm mb-3" style="color: var(--text-secondary);">
                                    <li>C is in NP (solutions can be verified in polynomial time)</li>
                                    <li>C is NP-hard (every NP problem reduces to C)</li>
                                </ol>
                                <p class="text-sm" style="color: var(--text-secondary);">
                                    If any NP-complete problem has a polynomial-time algorithm, then P = NP.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="flex justify-between mt-8">
                        <button class="btn-secondary" id="theory-prev-btn">‚Üê Overview</button>
                        <button class="btn-primary" id="theory-next-btn">SAT Solver ‚Üí</button>
                    </div>
                </div>
            </section>

            <!-- Section 3: SAT Solver -->
            <section class="content-section" id="sat">
                <div class="py-8">
                    <h2 class="text-4xl font-bold mb-6" style="color: var(--text-main);">SAT Solver</h2>
                    
                    <div class="card">
                        <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-indigo);">Boolean Satisfiability</h3>
                        <p class="mb-4" style="color: var(--text-secondary);">
                            The SAT problem asks whether there exists an assignment of truth values to variables that makes a Boolean formula true.
                        </p>
                        
                        <!-- Formula Input -->
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <label class="block text-sm font-medium" style="color: var(--text-main);">Build Boolean Formula:</label>
                                <button class="btn-secondary text-xs" id="toggle-input-mode">
                                    ‚å®Ô∏è Switch to Manual Input
                                </button>
                            </div>
                            
                            <!-- Expression Builder (default) -->
                            <div id="expression-builder" class="space-y-4">
                                <!-- Clauses Container -->
                                <div id="clauses-container" class="space-y-3">
                                    <!-- Initial clause will be added by JavaScript -->
                                </div>
                                
                                <!-- Add Clause Button -->
                                <div class="flex gap-2">
                                    <button class="btn-secondary text-sm" id="add-clause-btn">
                                        ‚ûï Add Clause
                                    </button>
                                    <button class="btn-secondary text-sm" id="generate-formula-btn">
                                        üîÑ Generate Formula
                                    </button>
                                </div>
                                
                                <!-- Generated Formula Display -->
                                <div class="p-3 rounded-lg border" style="background: var(--code-bg); border-color: var(--border-color);">
                                    <div class="text-xs font-medium mb-1" style="color: var(--text-secondary);">Generated Formula:</div>
                                    <div id="generated-formula" class="font-mono text-sm" style="color: var(--text-main);">
                                        (A OR B) AND (NOT A OR C)
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Manual Input (hidden by default) -->
                            <div id="manual-input" class="hidden">
                                <input type="text" id="sat-input" class="w-full p-3 rounded-lg border font-mono text-sm" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);" 
                                    placeholder="(A OR B) AND (NOT A OR C)" value="(A OR B) AND (NOT A OR C)">
                            </div>
                            
                            <div class="mt-2 flex flex-wrap gap-2">
                                <button class="btn-primary" id="sat-solve-btn">Solve SAT</button>
                                <button class="btn-secondary" id="sat-clear-btn">Clear</button>
                                <button class="btn-secondary toggle-btn" id="sat-truth-table-toggle" data-state="off">
                                    üìä Truth Table
                                </button>
                                <button class="btn-secondary toggle-btn" id="sat-auto-solve-toggle" data-state="off">
                                    ‚ö° Auto Solve
                                </button>
                            </div>
                            
                            <!-- Example formulas -->
                            <div class="mt-4">
                                <p class="text-sm font-medium mb-2" style="color: var(--text-secondary);">Try examples:</p>
                                <div class="flex flex-wrap gap-2">
                                    <button class="example-sat btn-secondary text-sm" data-formula="(A OR B) AND (NOT A OR C)">Simple</button>
                                    <button class="example-sat btn-secondary text-sm" data-formula="(X OR Y) AND (NOT X OR Z) AND (Y OR NOT Z)">3 variables</button>
                                    <button class="example-sat btn-secondary text-sm" data-formula="(A AND NOT A)">Contradiction</button>
                                    <button class="example-sat btn-secondary text-sm" data-formula="(A OR NOT A)">Tautology</button>
                                </div>
                            </div>
                            
                            <!-- Syntax guide -->
                            <div class="mt-4 p-3 rounded-lg text-xs" style="background: var(--code-bg);">
                                <p class="font-medium mb-1" style="color: var(--text-main);">Syntax:</p>
                                <p style="color: var(--text-secondary);">
                                    Use AND, OR, NOT with variables A-Z. Example: (A OR B) AND (NOT A OR C)
                                </p>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div id="sat-results" class="hidden">
                            <h4 class="font-bold mb-2" style="color: var(--text-main);">Solution:</h4>
                            <div id="sat-output" class="code-display mb-4"></div>
                            <div id="sat-assignment" class="p-3 rounded-lg" style="background: var(--code-bg);"></div>
                        </div>
                        
                        <!-- Truth Table -->
                        <div id="truth-table-container" class="hidden mt-6">
                            <h4 class="font-bold mb-2" style="color: var(--text-main);">Truth Table:</h4>
                            <div id="truth-table" class="overflow-x-auto"></div>
                        </div>
                    </div>

                    <!-- Complexity Visualization -->
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4" style="color: var(--primary-indigo);">Complexity Analysis</h3>
                        <p class="mb-4" style="color: var(--text-secondary);">
                            SAT solving requires checking up to 2^n assignments where n is the number of variables.
                        </p>
                        <div class="progress-bar mb-2">
                            <div class="progress-fill" id="sat-progress" style="width: 0%;"></div>
                        </div>
                        <p class="text-sm" style="color: var(--text-secondary);">
                            <span id="sat-progress-text">0%</span> of search space explored
                        </p>
                    </div>

                    <!-- Navigation -->
                    <div class="flex justify-between mt-8">
                        <button class="btn-secondary" id="sat-prev-btn">‚Üê Theory</button>
                        <button class="btn-primary" id="sat-next-btn">3-CNF ‚Üí</button>
                    </div>
                </div>
            </section>

            <!-- Section 4: 3-CNF -->
            <section class="content-section" id="3cnf">
                <div class="py-8">
                    <h2 class="text-4xl font-bold mb-6" style="color: var(--text-main);">3-CNF Conversion</h2>
                    
                    <div class="card">
                        <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-indigo);">3-Conjunctive Normal Form</h3>
                        <p class="mb-4" style="color: var(--text-secondary);">
                            3-CNF is a standardized format where each clause has exactly 3 literals. Any SAT formula can be converted to 3-CNF in polynomial time.
                        </p>
                        
                        <!-- Step-by-step conversion -->
                        <div id="3cnf-steps">
                            <div class="mb-6">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">Original Formula:</h4>
                                <div id="original-formula" class="code-display"></div>
                            </div>
                            
                            <div class="mb-6">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">Conversion Steps:</h4>
                                <div id="conversion-steps" class="space-y-3"></div>
                            </div>
                            
                            <div class="mb-6">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">Final 3-CNF:</h4>
                                <div id="final-3cnf" class="code-display"></div>
                            </div>
                        </div>
                        
                        <div class="mt-2 flex gap-2">
                                <button class="btn-primary" id="3cnf-convert-btn">Convert to 3-CNF</button>
                                <button class="btn-secondary" id="3cnf-animate-btn">Animate Steps</button>
                                <button class="btn-secondary toggle-btn" id="3cnf-show-all-toggle" data-state="off">
                                    üëÅÔ∏è Show All Steps
                                </button>
                                <button class="btn-secondary toggle-btn" id="3cnf-auto-play-toggle" data-state="off">
                                    ‚ñ∂Ô∏è Auto Play
                                </button>
                            </div>
                    </div>

                    <!-- Navigation -->
                    <div class="flex justify-between mt-8">
                        <button class="btn-secondary" id="3cnf-prev-btn">‚Üê SAT Solver</button>
                        <button class="btn-primary" id="3cnf-next-btn">Reduction ‚Üí</button>
                    </div>
                </div>
            </section>

            <!-- Section 5: Reduction -->
            <section class="content-section" id="reduction">
                <div class="py-8">
                    <h2 class="text-4xl font-bold mb-6" style="color: var(--text-main);">3-SAT ‚Üí CLIQUE Reduction</h2>
                    
                    <div class="card">
                        <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-indigo);">Understanding the Reduction</h3>
                        <p class="mb-4" style="color: var(--text-secondary);">
                            We transform a 3-SAT problem into a CLIQUE problem while preserving satisfiability.
                        </p>
                        
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">3-SAT Instance:</h4>
                                <div id="reduction-3cnf" class="code-display"></div>
                            </div>
                            <div>
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">CLIQUE Instance:</h4>
                                <div id="reduction-clique" class="code-display"></div>
                            </div>
                        </div>
                        
                        <!-- Step-through controls -->
                        <div class="mb-6">
                            <h4 class="font-bold mb-2" style="color: var(--text-main);">Step-by-Step Construction:</h4>
                            <div class="flex gap-2 mb-4">
                                <button class="btn-secondary" id="reduction-prev-btn-step">‚Üê Previous</button>
                                <button class="btn-primary" id="reduction-play-btn">‚ñ∂ Play</button>
                                <button class="btn-secondary" id="reduction-next-btn-step">Next ‚Üí</button>
                                <button class="btn-secondary" id="reduction-reset-btn">Reset</button>
                            </div>
                            <div id="reduction-step-display" class="code-display"></div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="flex justify-between mt-8">
                        <button class="btn-secondary" id="reduction-prev-btn">‚Üê 3-CNF</button>
                        <button class="btn-primary" id="reduction-next-btn">Visualizer ‚Üí</button>
                    </div>
                </div>
            </section>

            <!-- Section 6: Visualizer -->
            <section class="content-section" id="visualizer">
                <div class="py-8">
                    <h2 class="text-4xl font-bold mb-6" style="color: var(--text-main);">Interactive Graph Visualizer</h2>
                    
                    <div class="card">
                        <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-indigo);">CLIQUE Graph</h3>
                        
                        <!-- Input and Controls -->
                        <div class="mb-6">
                            <div class="flex flex-col md:flex-row gap-4 mb-4">
                                <input type="text" id="viz-formula-input" class="flex-1 p-3 rounded-lg border" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);" 
                                    placeholder="Enter formula..." value="(A OR B OR C) AND (NOT A OR D OR E)">
                                <button class="btn-primary" id="viz-build-btn">Build Graph</button>
                            </div>
                            
                            <!-- Example formulas -->
                            <div class="mb-4">
                                <p class="text-sm font-medium mb-2" style="color: var(--text-secondary);">Try examples:</p>
                                <div class="flex flex-wrap gap-2">
                                    <button class="example-formula btn-secondary text-sm" data-formula="(A OR B OR C) AND (NOT A OR D OR E)">Simple</button>
                                    <button class="example-formula btn-secondary text-sm" data-formula="(X OR Y) AND (NOT X OR Z)">2 variables</button>
                                    <button class="example-formula btn-secondary text-sm" data-formula="(P OR Q OR NOT R) AND (NOT P OR S OR T) AND (NOT Q OR NOT S OR U)">Complex</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Graph Display -->
                        <div id="clique-graph-container"></div>
                        
                        <!-- Graph Controls -->
                        <div class="mt-6 flex flex-wrap gap-2">
                            <button class="btn-primary" id="find-clique-btn">Find Satisfying Clique</button>
                            <button class="btn-secondary" id="reset-graph-btn">Reset Graph</button>
                            <button class="btn-secondary" id="auto-layout-btn">Auto Layout</button>
                            <button class="btn-secondary toggle-btn" id="viz-labels-toggle" data-state="on">
                                üè∑Ô∏è Labels
                            </button>
                            <button class="btn-secondary toggle-btn" id="viz-edges-toggle" data-state="on">
                                üîó Edges
                            </button>
                            <button class="btn-secondary toggle-btn" id="viz-highlight-toggle" data-state="off">
                                ‚ú® Highlight Mode
                            </button>
                        </div>
                        
                        <!-- Results -->
                        <div id="clique-results" class="hidden mt-6">
                            <h4 class="font-bold mb-2" style="color: var(--text-main);">Results:</h4>
                            <div id="clique-output" class="p-3 rounded-lg" style="background: var(--code-bg);"></div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="flex justify-between mt-8">
                        <button class="btn-secondary" id="viz-prev-btn">‚Üê Reduction</button>
                        <button class="btn-primary" id="viz-next-btn">Practice ‚Üí</button>
                    </div>
                </div>
            </section>

        <!-- Section 7: Practice -->
            <section class="content-section" id="practice">
                <div class="py-8">
                    <h2 class="text-4xl font-bold mb-6" style="color: var(--text-main);">Practice Problems</h2>
                    
                    <!-- Difficulty Selection -->
                    <div class="card mb-6">
                        <h3 class="text-xl font-bold mb-4" style="color: var(--primary-indigo);">Select Difficulty</h3>
                        <div class="flex gap-2">
                            <button class="btn-primary difficulty-btn" data-difficulty="easy">Easy</button>
                            <button class="btn-primary difficulty-btn" data-difficulty="medium">Medium</button>
                            <button class="btn-secondary difficulty-btn" data-difficulty="hard">Hard</button>
                            <button class="btn-secondary toggle-btn" id="practice-hints-toggle" data-state="on">
                                üí° Hints
                            </button>
                            <button class="btn-secondary toggle-btn" id="practice-auto-check-toggle" data-state="off">
                                ‚úì Auto Check
                            </button>
                            <button class="btn-secondary toggle-btn" id="practice-timer-toggle" data-state="off">
                                ‚è±Ô∏è Timer
                            </button>
                        </div>
                    </div>
                    
                    <!-- Problem Display -->
                    <div class="card">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold" style="color: var(--primary-indigo);">
                                Problem <span id="problem-number">1</span> of <span id="total-problems">5</span>
                            </h3>
                            <div class="flex gap-2">
                                <button class="btn-secondary" id="hint-btn">üí° Hint</button>
                                <button class="btn-secondary" id="skip-btn">Skip</button>
                            </div>
                        </div>
                        
                        <div id="problem-content">
                            <h4 class="font-bold mb-2" style="color: var(--text-main);">Task:</h4>
                            <p id="problem-description" class="mb-4" style="color: var(--text-secondary);"></p>
                            
                            <div id="problem-input-area">
                                <!-- Dynamic input area based on problem type -->
                            </div>
                        </div>
                        
                        <!-- Hint Display -->
                        <div id="hint-display" class="hidden mt-4 p-3 rounded-lg" style="background: var(--code-bg);">
                            <h4 class="font-bold mb-2" style="color: var(--text-main);">Hint:</h4>
                            <p id="hint-text" style="color: var(--text-secondary);"></p>
                        </div>
                        
                        <!-- Submit and Feedback -->
                        <div class="mt-6">
                            <button class="btn-primary" id="submit-answer-btn">Submit Answer</button>
                            <div id="feedback" class="hidden mt-4 p-3 rounded-lg">
                                <p id="feedback-text"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="flex justify-between mt-8">
                        <button class="btn-secondary" id="practice-prev-btn">‚Üê Visualizer</button>
                        <button class="btn-primary" id="practice-next-btn">Quiz ‚Üí</button>
                    </div>
                </div>
            </section>

            <!-- Section 8: Quiz -->
            <section class="content-section" id="quiz">
                <div class="py-8">
                    <h2 class="text-4xl font-bold mb-6" style="color: var(--text-main);">Quiz</h2>
                    
                    <!-- Quiz Settings -->
                    <div class="card mb-6">
                        <h3 class="text-xl font-bold mb-4" style="color: var(--primary-indigo);">Quiz Settings</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-main);">Number of Questions:</label>
                                <select id="quiz-length" class="w-full p-2 rounded-lg border" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);">
                                    <option value="5">5 Questions</option>
                                    <option value="10" selected>10 Questions</option>
                                    <option value="15">15 Questions</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-main);">Time Limit:</label>
                                <select id="quiz-timer" class="w-full p-2 rounded-lg border" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);">
                                    <option value="0">No Time Limit</option>
                                    <option value="300">5 Minutes</option>
                                    <option value="600">10 Minutes</option>
                                    <option value="900">15 Minutes</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button class="btn-primary mt-4" id="start-quiz-btn">Start Quiz</button>
                            <button class="btn-secondary toggle-btn mt-4" id="quiz-feedback-toggle" data-state="on">
                                üí¨ Feedback
                            </button>
                            <button class="btn-secondary toggle-btn mt-4" id="quiz-instant-check-toggle" data-state="off">
                                ‚úì Instant Check
                            </button>
                            <button class="btn-secondary toggle-btn mt-4" id="quiz-review-toggle" data-state="off">
                                üëÅÔ∏è Review Mode
                            </button>
                        </div>
                    </div>
                    
                    <!-- Quiz Content -->
                    <div id="quiz-content" class="hidden">
                        <!-- Timer -->
                        <div class="card mb-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-bold" style="color: var(--text-main);">
                                    Question <span id="quiz-question-number">1</span> of <span id="quiz-total-questions">10</span>
                                </h3>
                                <div class="flex items-center gap-4">
                                    <div class="text-sm font-medium" style="color: var(--text-secondary);">
                                        Time: <span id="quiz-timer-display">10:00</span>
                                    </div>
                                    <div class="text-sm font-medium" style="color: var(--text-secondary);">
                                        Score: <span id="quiz-score">0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="progress-bar mt-2">
                                <div class="progress-fill" id="quiz-progress" style="width: 0%;"></div>
                            </div>
                        </div>
                        
                        <!-- Question -->
                        <div class="card">
                            <h4 id="quiz-question" class="text-lg font-bold mb-4" style="color: var(--text-main);"></h4>
                            <div id="quiz-options" class="space-y-3">
                                <!-- Dynamic options -->
                            </div>
                            <button class="btn-primary mt-4" id="quiz-submit-answer">Submit Answer</button>
                        </div>
                    </div>
                    
                    <!-- Quiz Results -->
                    <div id="quiz-results" class="hidden">
                        <div class="card">
                            <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-indigo);">Quiz Complete!</h3>
                            <div class="text-center mb-6">
                                <div class="text-5xl font-bold mb-2" style="color: var(--primary-indigo);">
                                    <span id="final-score">0</span>%
                                </div>
                                <p class="text-lg" style="color: var(--text-secondary);">
                                    You got <span id="correct-answers">0</span> out of <span id="total-quiz-questions">10</span> questions correct.
                                </p>
                            </div>
                            <div class="flex gap-2 justify-center">
                                <button class="btn-primary" id="retake-quiz-btn">Retake Quiz</button>
                                <button class="btn-secondary" id="review-answers-btn">Review Answers</button>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="flex justify-between mt-8">
                        <button class="btn-secondary" id="quiz-prev-btn">‚Üê Practice</button>
                        <button class="btn-primary" id="quiz-next-btn">Glossary ‚Üí</button>
                    </div>
                </div>
            </section>

            <!-- Section 9: Glossary -->
            <section class="content-section" id="glossary">
                <div class="py-8">
                    <h2 class="text-4xl font-bold mb-6" style="color: var(--text-main);">Glossary & Examples</h2>
                    
                    <!-- Search -->
                    <div class="card mb-6">
                        <input type="text" id="glossary-search" class="w-full p-3 rounded-lg border" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);" 
                            placeholder="Search terms...">
                    </div>
                    
                    <!-- Terms Grid -->
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2" style="color: var(--primary-indigo);">Clause</h3>
                            <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                A disjunction (OR) of literals in a Boolean formula.
                            </p>
                            <div class="code-display text-sm">(A OR B OR NOT C)</div>
                        </div>
                        
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2" style="color: var(--primary-indigo);">Literal</h3>
                            <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                A variable or its negation in a Boolean formula.
                            </p>
                            <div class="code-display text-sm">A, NOT B, X, NOT Y</div>
                        </div>
                        
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2" style="color: var(--primary-indigo);">CNF</h3>
                            <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                Conjunctive Normal Form: conjunction of clauses.
                            </p>
                            <div class="code-display text-sm">(A OR B) AND (C OR NOT D)</div>
                        </div>
                        
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2" style="color: var(--primary-indigo);">Reduction</h3>
                            <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                Transform one problem into another in polynomial time.
                            </p>
                            <div class="code-display text-sm">3-SAT ‚â§p CLIQUE</div>
                        </div>
                        
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2" style="color: var(--primary-indigo);">Clique</h3>
                            <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                Complete subgraph where every vertex is connected.
                            </p>
                            <div class="code-display text-sm">Find k-clique in graph G</div>
                        </div>
                        
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2" style="color: var(--primary-indigo);">Satisfiable</h3>
                            <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                A Boolean formula that can be made true.
                            </p>
                            <div class="code-display text-sm">‚àÉ assignment: formula = true</div>
                        </div>
                    </div>
                    
                    <!-- NP-Complete Problems Gallery -->
                    <div class="card">
                        <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-indigo);">Canonical NP-Complete Problems</h3>
                        <div class="space-y-4">
                            <div class="p-4 rounded-lg" style="background: var(--code-bg);">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">SAT (Boolean Satisfiability)</h4>
                                <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                    Given a Boolean formula, is there an assignment that makes it true?
                                </p>
                                <p class="text-xs" style="color: var(--text-secondary);">Reduction: Cook-Levin theorem (1971)</p>
                            </div>
                            
                            <div class="p-4 rounded-lg" style="background: var(--code-bg);">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">3-SAT</h4>
                                <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                    SAT with exactly 3 literals per clause.
                                </p>
                                <p class="text-xs" style="color: var(--text-secondary);">Reduction: SAT ‚â§p 3-SAT</p>
                            </div>
                            
                            <div class="p-4 rounded-lg" style="background: var(--code-bg);">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">CLIQUE</h4>
                                <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                    Given a graph G and integer k, does G contain a clique of size k?
                                </p>
                                <p class="text-xs" style="color: var(--text-secondary);">Reduction: 3-SAT ‚â§p CLIQUE</p>
                            </div>
                            
                            <div class="p-4 rounded-lg" style="background: var(--code-bg);">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">Vertex Cover</h4>
                                <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                    Given a graph G and integer k, is there a vertex cover of size k?
                                </p>
                                <p class="text-xs" style="color: var(--text-secondary);">Reduction: CLIQUE ‚â§p Vertex Cover</p>
                            </div>
                            
                            <div class="p-4 rounded-lg" style="background: var(--code-bg);">
                                <h4 class="font-bold mb-2" style="color: var(--text-main);">Hamiltonian Cycle</h4>
                                <p class="text-sm mb-2" style="color: var(--text-secondary);">
                                    Given a graph G, does G contain a cycle visiting each vertex exactly once?
                                </p>
                                <p class="text-xs" style="color: var(--text-secondary);">Reduction: SAT ‚â§p Hamiltonian Cycle</p>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="flex justify-between mt-8">
                        <button class="btn-secondary" id="glossary-prev-btn">‚Üê Quiz</button>
                        <button class="btn-primary" id="glossary-next-btn">üèÅ Complete</button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Modals (hidden by default) -->
    <div id="cheat-sheet-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg max-w-4xl max-h-[80vh] overflow-y-auto p-6">
            <h2 class="text-2xl font-bold mb-4">NP-Completeness Cheat Sheet</h2>
            <div class="space-y-4">
                <div>
                    <h3 class="font-bold mb-2">Key Definitions</h3>
                    <ul class="list-disc pl-6 text-sm space-y-1">
                        <li><strong>P:</strong> Problems solvable in polynomial time</li>
                        <li><strong>NP:</strong> Problems verifiable in polynomial time</li>
                        <li><strong>NP-hard:</strong> At least as hard as any NP problem</li>
                        <li><strong>NP-complete:</strong> In NP and NP-hard</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold mb-2">SAT ‚Üí 3-CNF ‚Üí CLIQUE</h3>
                    <ol class="list-decimal pl-6 text-sm space-y-1">
                        <li>Convert SAT formula to 3-CNF</li>
                        <li>Create graph nodes for each literal</li>
                        <li>Add edges between non-contradictory literals</li>
                        <li>Find clique of size k (number of clauses)</li>
                    </ol>
                </div>
                <div>
                    <h3 class="font-bold mb-2">Common Reductions</h3>
                    <ul class="list-disc pl-6 text-sm space-y-1">
                        <li>SAT ‚â§p 3-SAT (pad/duplicate literals)</li>
                        <li>3-SAT ‚â§p CLIQUE (graph construction)</li>
                        <li>CLIQUE ‚â§p Vertex Cover (complement graph)</li>
                    </ul>
                </div>
            </div>
            <button class="btn-secondary mt-4" onclick="closeModal('cheat-sheet-modal')">Close</button>
        </div>
    </div>

    <div id="notes-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg max-w-4xl max-h-[80vh] overflow-y-auto p-6">
            <h2 class="text-2xl font-bold mb-4">Teacher Notes</h2>
            <div class="space-y-4">
                <div>
                    <h3 class="font-bold mb-2">Learning Objectives</h3>
                    <ul class="list-disc pl-6 text-sm space-y-1">
                        <li>Understand P vs NP and computational complexity</li>
                        <li>Master polynomial-time reductions</li>
                        <li>Visualize SAT ‚Üí CLIQUE reduction</li>
                        <li>Apply concepts to practice problems</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold mb-2">Teaching Tips</h3>
                    <ul class="list-disc pl-6 text-sm space-y-1">
                        <li>Start with simple 2-variable examples</li>
                        <li>Emphasize the "preservation" property of reductions</li>
                        <li>Use the visualizer to show graph construction step-by-step</li>
                        <li>Have students work through practice problems in pairs</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold mb-2">Assessment Ideas</h3>
                    <ul class="list-disc pl-6 text-sm space-y-1">
                        <li>Quiz: Identify problem classes (P, NP, NP-complete)</li>
                        <li>Exercise: Convert formulas to 3-CNF</li>
                        <li>Project: Implement a simple SAT solver</li>
                        <li>Presentation: Research another NP-complete problem</li>
                    </ul>
                </div>
            </div>
            <button class="btn-secondary mt-4" onclick="closeModal('notes-modal')">Close</button>
        </div>
    </div>

    <div id="dev-panel-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg max-w-4xl max-h-[80vh] overflow-y-auto p-6">
            <h2 class="text-2xl font-bold mb-4">Development Panel</h2>
            <div class="space-y-4">
                <div>
                    <h3 class="font-bold mb-2">Unit Tests</h3>
                    <div id="test-results" class="code-display text-sm">
                        <p>Running tests...</p>
                    </div>
                </div>
                <div>
                    <h3 class="font-bold mb-2">Performance Metrics</h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <p><strong>Page Load:</strong> <span id="load-time">0ms</span></p>
                            <p><strong>Memory:</strong> <span id="memory-usage">0MB</span></p>
                        </div>
                        <div>
                            <p><strong>Active Workers:</strong> <span id="worker-count">0</span></p>
                            <p><strong>Cache Size:</strong> <span id="cache-size">0KB</span></p>
                        </div>
                    </div>
                </div>
                <div>
                    <h3 class="font-bold mb-2">Debug Tools</h3>
                    <div class="flex gap-2">
                        <button class="btn-secondary text-sm" onclick="runTests()">Run Tests</button>
                        <button class="btn-secondary text-sm" onclick="clearCache()">Clear Cache</button>
                        <button class="btn-secondary text-sm" onclick="exportData()">Export Data</button>
                    </div>
                </div>
            </div>
            <button class="btn-secondary mt-4" onclick="closeModal('dev-panel-modal')">Close</button>
        </div>
    </div>
                        <script>
        // =================================================================
        // NP-COMPLETENESS LEARNING PLATFORM - COMPREHENSIVE JAVASCRIPT
        // =================================================================
        
        // =================================================================
        // GLOBAL STATE MANAGEMENT
        // =================================================================
        
        const app = {
            currentSection: 'overview',
            completedSections: new Set(),
            progress: 0,
            isDarkMode: true,
            
            // SAT Solver state
            satSolver: {
                currentFormula: '',
                assignments: [],
                isSearching: false,
                showTruthTable: false,
                autoSolve: false
            },
            
            // 3-CNF conversion state
            cnfConverter: {
                originalFormula: '',
                conversionSteps: [],
                currentStep: 0,
                isAnimating: false,
                showAllSteps: false,
                autoPlay: false
            },
            
            // Reduction state
            reduction: {
                formula: '',
                currentStep: 0,
                isPlaying: false,
                showDetails: false,
                autoAdvance: false
            },
            
            // Visualizer state
            visualizer: {
                cy: null,
                currentFormula: '',
                graphData: null,
                showLabels: true,
                showEdges: true,
                autoLayout: false,
                highlightMode: false
            },
            
            // Practice state
            practice: {
                difficulty: 'medium',
                currentProblem: 0,
                problems: [],
                hintsShown: 0,
                showHints: true,
                autoCheck: false,
                timerMode: false
            },
            
            // Quiz state
            quiz: {
                questions: [],
                currentQuestion: 0,
                score: 0,
                answers: [],
                timer: null,
                timeLimit: 0,
                showFeedback: true,
                instantCheck: false,
                reviewMode: false
            },
            
            // Expression Builder state
            expressionBuilder: {
                clauses: [],
                variables: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'X', 'Y', 'Z'],
                operators: ['OR', 'AND', 'XOR', 'NOR', 'NAND'],
                clauseOperators: ['OR', 'AND', 'XOR'],
                isManualMode: false
            },
            
            // Initialize app
            init() {
                this.loadProgress();
                this.setupEventListeners();
                this.setupKeyboardShortcuts();
                this.updateProgressDisplay();
                this.initializePracticeProblems();
                this.initializeQuizQuestions();
                this.initializeGlossary();
                this.initializeExpressionBuilder();
                this.initializeHamburgerToggle();
            },
            
            initializeHamburgerToggle() {
                // Set initial state based on screen size and user preference
                const navStepper = document.getElementById('nav-stepper');
                const hamburgerToggle = document.getElementById('hamburger-toggle');
                
                if (navStepper) {
                    // Check if user has a saved preference
                    const savedState = localStorage.getItem('sidebar-state');
                    
                    if (savedState === 'hidden') {
                        navStepper.classList.add('mobile-hidden');
                        if (hamburgerToggle) hamburgerToggle.classList.remove('active');
                    } else if (savedState === 'visible') {
                        navStepper.classList.remove('mobile-hidden');
                        if (hamburgerToggle) hamburgerToggle.classList.add('active');
                    } else {
                        // No saved preference, use default based on screen size
                        if (window.innerWidth <= 768) {
                            navStepper.classList.add('mobile-hidden');
                            if (hamburgerToggle) hamburgerToggle.classList.remove('active');
                        } else {
                            navStepper.classList.remove('mobile-hidden');
                            if (hamburgerToggle) hamburgerToggle.classList.add('active');
                        }
                    }
                }
            },
            
            toggleSidebar() {
                const navStepper = document.getElementById('nav-stepper');
                const hamburgerToggle = document.getElementById('hamburger-toggle');
                
                if (navStepper && hamburgerToggle) {
                    navStepper.classList.toggle('mobile-hidden');
                    hamburgerToggle.classList.toggle('active');
                    
                    // Save the state to localStorage
                    const isHidden = navStepper.classList.contains('mobile-hidden');
                    localStorage.setItem('sidebar-state', isHidden ? 'hidden' : 'visible');
                }
            },
            
            // Load saved progress from localStorage
            loadProgress() {
                const saved = localStorage.getItem('np-completeness-progress');
                if (saved) {
                    const data = JSON.parse(saved);
                    this.completedSections = new Set(data.completedSections || []);
                    this.progress = data.progress || 0;
                }
            },
            
            // Save progress to localStorage
            saveProgress() {
                const data = {
                    completedSections: Array.from(this.completedSections),
                    progress: this.progress
                };
                localStorage.setItem('np-completeness-progress', JSON.stringify(data));
            },
            
            // Mark section as completed
            completeSection(sectionId) {
                this.completedSections.add(sectionId);
                this.updateProgress();
                this.saveProgress();
            },
            
            // Update progress calculations
            updateProgress() {
                const totalSections = 9;
                this.progress = Math.round((this.completedSections.size / totalSections) * 100);
                this.updateProgressDisplay();
            },
            
            // Update progress UI
            updateProgressDisplay() {
                const progressBar = document.getElementById('overall-progress');
                const progressText = document.getElementById('progress-text');
                const sectionsCompleted = document.getElementById('sections-completed');
                
                if (progressBar) progressBar.style.width = `${this.progress}%`;
                if (progressText) progressText.textContent = `${this.progress}%`;
                if (sectionsCompleted) sectionsCompleted.textContent = this.completedSections.size;
                
                // Update navigation progress indicators
                this.updateNavigationProgress();
                
                // Update step progress bar
                this.updateStepProgressBar();
            },
            
            // Update navigation progress indicators (removed dots, using visual indicators only)
            updateNavigationProgress() {
                const sections = ['overview', 'theory', 'sat', '3cnf', 'reduction', 'visualizer', 'practice', 'quiz', 'glossary'];
                const currentIndex = sections.indexOf(this.currentSection);
                
                sections.forEach((section, index) => {
                    const navItem = document.querySelector(`[data-section="${section}"]`);
                    if (navItem) {
                        // Update active state
                        if (index === currentIndex) {
                            navItem.classList.add('active');
                        } else {
                            navItem.classList.remove('active');
                        }
                    }
                });
            },
            
            // Update step progress bar
            updateStepProgressBar() {
                const sections = ['overview', 'theory', 'sat', '3cnf', 'reduction', 'visualizer', 'practice', 'quiz', 'glossary'];
                const currentIndex = sections.indexOf(this.currentSection);
                const totalSections = sections.length;
                const progressPercentage = (currentIndex / (totalSections - 1)) * 100;
                
                const progressFill = document.getElementById('step-progress-fill');
                if (progressFill) {
                    progressFill.style.height = `${progressPercentage}%`;
                }
            },
            
            // Navigate to section
            navigateToSection(sectionId) {
                // Hide all sections
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Show target section
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.add('active');
                    this.currentSection = sectionId;
                    
                    // Update pseudo code if panel is visible
                    const panel = document.getElementById('pseudo-code-panel');
                    if (panel && panel.classList.contains('visible')) {
                        this.updatePseudoCodeForCurrentSection();
                    }
                    
                    // Update navigation
                    document.querySelectorAll('.nav-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
                    
                    // Mark as completed (except overview)
                    if (sectionId !== 'overview') {
                        this.completeSection(sectionId);
                    }
                    
                    // Close mobile menu
                    if (window.innerWidth <= 768) {
                        document.getElementById('nav-stepper').classList.add('mobile-hidden');
                    }
                    
                    // Initialize section-specific content
                    this.initializeSection(sectionId);
                }
            },
            
            // Initialize section-specific content
            initializeSection(sectionId) {
                // Initialize animations for the new section
                setTimeout(() => {
                    this.initializeAnimations();
                }, 100);
                
                // Update learning assistant content
                this.updateAssistantContent();
                
                switch(sectionId) {
                    case 'sat':
                        this.initializeSATSolver();
                        break;
                    case '3cnf':
                        this.initialize3CNFConverter();
                        break;
                    case 'reduction':
                        this.initializeReduction();
                        break;
                    case 'visualizer':
                        this.initializeVisualizer();
                        break;
                    case 'practice':
                        this.loadPracticeProblem();
                        break;
                    case 'quiz':
                        this.initializeQuiz();
                        break;
                    case 'overview':
                        // Initialize overview animations
                        this.initializeOverviewAnimations();
                        break;
                }
            },
            
            // Initialize overview-specific animations
            initializeOverviewAnimations() {
                // Animate progress bar
                const progressBar = document.getElementById('overall-progress');
                if (progressBar) {
                    setTimeout(() => {
                        progressBar.style.width = `${this.progress}%`;
                    }, 500);
                }
                
                // Animate feature cards with stagger
                document.querySelectorAll('.concept-card').forEach((card, index) => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(30px)';
                    setTimeout(() => {
                        card.style.transition = 'all 0.6s ease';
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, 300 + (index * 200));
                });
            },
            
            // Learning Assistant Functions
            toggleLearningAssistant() {
                const panel = document.getElementById('assistant-panel');
                if (panel) {
                    panel.classList.toggle('visible');
                    if (panel.classList.contains('visible')) {
                        this.updateAssistantContent();
                    }
                }
            },
            
            updateAssistantContent() {
                const content = document.getElementById('assistant-content');
                const sectionHints = {
                    'overview': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üéØ Getting Started</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            Welcome! This platform will teach you NP-Completeness through interactive visualizations.
                        </p>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <strong>Current Step:</strong> Understanding the learning path<br>
                            <strong>Next:</strong> Move to Theory section to learn P vs NP
                        </div>
                    `,
                    'theory': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üìö Theory Section</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            Here you'll learn the fundamental concepts of computational complexity.
                        </p>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <strong>Key Concepts:</strong> P vs NP, reductions, completeness<br>
                            <strong>Focus on:</strong> Understanding why some problems are harder than others
                        </div>
                    `,
                    'sat': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üîç SAT Solver</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            The Boolean satisfiability problem is the first NP-Complete problem.
                        </p>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <strong>Try this:</strong> Enter a simple formula like (A ‚à® B) ‚àß (¬¨A ‚à® C)<br>
                            <strong>Watch:</strong> How the solver finds satisfying assignments
                        </div>
                    `,
                    '3cnf': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üîÑ 3-CNF Conversion</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            Converting formulas to 3-CNF is a crucial step in polynomial reductions.
                        </p>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <strong>Process:</strong> Each clause must have exactly 3 literals<br>
                            <strong>Why:</strong> Standardized form makes reductions easier
                        </div>
                    `,
                    'reduction': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">‚¨áÔ∏è 3-SAT ‚Üí CLIQUE</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            Watch how we transform a logic problem into a graph problem!
                        </p>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <strong>Key Insight:</strong> Satisfiable formula ‚Üí Complete graph<br>
                            <strong>Each clause:</strong> Becomes a group of connected vertices
                        </div>
                    `,
                    'visualizer': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üé® Interactive Visualizer</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            Explore the relationship between formulas and graphs interactively.
                        </p>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <strong>Experiment:</strong> Try different formulas and see the graphs<br>
                            <strong>Observe:</strong> How clause size affects graph structure
                        </div>
                    `,
                    'practice': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üí™ Practice Problems</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            Test your understanding with hands-on exercises.
                        </p>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <strong>Strategy:</strong> Start with easy problems<br>
                            <strong>Use hints:</strong> Click the hint button if you're stuck
                        </div>
                    `,
                    'quiz': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üìù Quiz Time</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            Test your knowledge of NP-Completeness concepts.
                        </p>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <strong>Remember:</strong> Each question teaches a concept<br>
                            <strong>Review:</strong> Check explanations for wrong answers
                        </div>
                    `,
                    'glossary': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üìñ Reference Guide</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            Look up any term you don't understand.
                        </p>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <strong>Tip:</strong> Terms are organized by difficulty<br>
                            <strong>Examples:</strong> Each term includes practical examples
                        </div>
                    `
                };
                
                if (content) {
                    content.innerHTML = sectionHints[this.currentSection] || sectionHints['overview'];
                }
            },
            
            provideHint() {
                const hints = {
                    'overview': 'üí° Start by clicking on each feature card to see detailed explanations of what you\'ll learn.',
                    'theory': 'üí° Focus on understanding the difference between P and NP problems. Look for the polynomial-time verification examples.',
                    'sat': 'üí° Try the formula (A ‚à® B) ‚àß (¬¨A ‚à® C) ‚àß (¬¨B ‚à® ¬¨C). Watch how the solver explores different assignments.',
                    '3cnf': 'üí° Remember: every clause must have exactly 3 literals. Use auxiliary variables if needed.',
                    'reduction': 'üí° Pay attention to how each literal becomes a vertex, and each clause becomes a triangle.',
                    'visualizer': 'üí° Experiment with different clause sizes. Notice how 3-CNF creates the most interesting graphs.',
                    'practice': 'üí° Read the problem carefully first. Use the hint system to learn the reduction technique step by step.',
                    'quiz': 'üí° Take your time and think through each question. The explanations are more valuable than the answers.',
                    'glossary': 'üí° Use the search function to quickly find terms. Click on examples to see them in action.'
                };
                
                const content = document.getElementById('assistant-content');
                if (content) {
                    const currentContent = content.innerHTML;
                    content.innerHTML = `
                        <div class="p-3 rounded" style="background: rgba(139, 92, 246, 0.1); border-left: 3px solid var(--primary-indigo);">
                            <p class="text-sm font-semibold" style="color: var(--text-main);">${hints[this.currentSection] || hints['overview']}</p>
                        </div>
                        <div class="mt-3">
                            <button class="text-xs" style="color: var(--primary-indigo); cursor: pointer;" onclick="app.updateAssistantContent()">
                                ‚Üê Back to main content
                            </button>
                        </div>
                    `;
                }
            },
            
            explainCurrentConcept() {
                const explanations = {
                    'overview': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üéØ What is NP-Completeness?</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            NP-Completeness is a concept in computer science that helps us understand which problems are 
                            computationally difficult to solve.
                        </p>
                        <div class="text-xs p-2 rounded" style="background: var(--code-bg); color: var(--text-secondary);">
                            <strong>Analogy:</strong> Think of it like a puzzle. Some puzzles have quick solutions (P), 
                            some we can quickly check if given a solution (NP), and NP-Complete problems are the "hardest" 
                            in NP - if you can solve one, you can solve all NP problems!
                        </div>
                    `,
                    'theory': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üßÆ P vs NP Explained</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            <strong>P problems:</strong> Can be solved quickly (in polynomial time)<br>
                            <strong>NP problems:</strong> Solutions can be checked quickly<br>
                            <strong>NP-Complete:</strong> The hardest problems in NP
                        </p>
                        <div class="text-xs p-2 rounded" style="background: var(--code-bg); color: var(--text-secondary);">
                            <strong>Why it matters:</strong> If P = NP, then all problems with quickly verifiable solutions 
                            also have quickly solvable algorithms. This would revolutionize cryptography, optimization, and AI!
                        </div>
                    `,
                    'sat': `
                        <h4 class="font-semibold mb-2" style="color: var(--text-main);">üîç SAT Problem</h4>
                        <p class="text-sm mb-3" style="color: var(--text-secondary);">
                            The SAT problem asks: Given a Boolean formula, is there an assignment of true/false values 
                            to variables that makes the entire formula true?
                        </p>
                        <div class="text-xs p-2 rounded" style="background: var(--code-bg); color: var(--text-secondary);">
                            <strong>Example:</strong> (A ‚à® B) ‚àß (¬¨A ‚à® C) is satisfiable with A=true, B=false, C=true<br>
                            <strong>Significance:</strong> First problem proven NP-Complete (Cook-Levin theorem)
                        </div>
                    `
                };
                
                const content = document.getElementById('assistant-content');
                if (content && explanations[this.currentSection]) {
                    content.innerHTML = explanations[this.currentSection];
                }
            },
            
            suggestNextStep() {
                const nextSteps = {
                    'overview': 'üëâ Ready to dive in? Navigate to the <strong>Theory</strong> section to learn about P vs NP problems.',
                    'theory': 'üëâ Now try the <strong>SAT Solver</strong> to see NP-Completeness in action with Boolean formulas.',
                    'sat': 'üëâ Learn how to convert formulas to standard form in the <strong>3-CNF</strong> section.',
                    '3cnf': 'üëâ Watch the amazing transformation in the <strong>Reduction</strong> section - from logic to graphs!',
                    'reduction': 'üëâ Explore the visual representation in the <strong>Visualizer</strong> section.',
                    'visualizer': 'üëâ Test your skills with <strong>Practice Problems</strong>.',
                    'practice': 'üëâ Take the <strong>Quiz</strong> to check your understanding.',
                    'quiz': 'üëâ Review any unfamiliar terms in the <strong>Glossary</strong>.',
                    'glossary': 'üéâ Congratulations! You\'ve completed the learning path. Try the practice problems again, or explore any section that interests you.'
                };
                
                const content = document.getElementById('assistant-content');
                if (content) {
                    content.innerHTML = `
                        <div class="p-3 rounded" style="background: rgba(16, 185, 129, 0.1); border-left: 3px solid #10b981;">
                            <p class="text-sm" style="color: var(--text-main);">${nextSteps[this.currentSection]}</p>
                        </div>
                        <div class="mt-3">
                            <button class="text-xs" style="color: var(--primary-indigo); cursor: pointer;" onclick="app.updateAssistantContent()">
                                ‚Üê Back to main content
                            </button>
                        </div>
                    `;
                }
            },
            
            // Animation Functions
            animateConceptCard(card, show) {
                const explanation = card.querySelector('.step-explanation');
                if (explanation) {
                    if (show) {
                        setTimeout(() => {
                            explanation.classList.add('visible');
                        }, 100);
                    } else {
                        explanation.classList.remove('visible');
                    }
                }
            },
            
            showConceptDetails(card) {
                const step = card.getAttribute('data-step');
                const details = {
                    '1': 'The theory section introduces the fundamental concepts. You\'ll learn about polynomial time algorithms, verification vs solving, and why some problems are inherently harder than others.',
                    '2': 'Visualizations help you understand abstract concepts. Watch how logical formulas transform into graph problems through step-by-step animations.',
                    '3': 'Practice reinforces learning. Try problems of increasing difficulty, get hints when stuck, and receive immediate feedback to improve your understanding.'
                };
                
                if (details[step]) {
                    // Create a temporary highlight effect
                    card.classList.add('highlight');
                    setTimeout(() => {
                        card.classList.remove('highlight');
                    }, 2000);
                }
            },
            
            // Initialize animations for current section
            initializeAnimations() {
                // Animate concept cards on load
                document.querySelectorAll('.concept-card').forEach((card, index) => {
                    setTimeout(() => {
                        card.classList.add('visible');
                    }, index * 200);
                });
                
                // Animate step explanations
                document.querySelectorAll('.step-explanation').forEach((explanation, index) => {
                    setTimeout(() => {
                        explanation.classList.add('visible');
                    }, 500 + (index * 150));
                });
            },
            
            // Setup event listeners
            setupEventListeners() {
                // Navigation items
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const section = item.getAttribute('data-section');
                        this.navigateToSection(section);
                    });
                    
                    item.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            const section = item.getAttribute('data-section');
                            this.navigateToSection(section);
                        }
                    });
                });
                
                // Learning assistant
                const learningAssistant = document.getElementById('learning-assistant');
                const assistantPanel = document.getElementById('assistant-panel');
                
                if (learningAssistant && assistantPanel) {
                    learningAssistant.addEventListener('click', () => {
                        this.toggleLearningAssistant();
                    });
                    
                    // Assistant buttons
                    document.getElementById('assistant-hint-btn')?.addEventListener('click', () => {
                        this.provideHint();
                    });
                    
                    document.getElementById('assistant-explain-btn')?.addEventListener('click', () => {
                        this.explainCurrentConcept();
                    });
                    
                    document.getElementById('assistant-next-btn')?.addEventListener('click', () => {
                        this.suggestNextStep();
                    });
                }
                
                // Concept card animations
                document.querySelectorAll('.concept-card').forEach((card, index) => {
                    card.addEventListener('mouseenter', () => {
                        this.animateConceptCard(card, true);
                    });
                    
                    card.addEventListener('click', () => {
                        this.showConceptDetails(card);
                    });
                });
                
                // Mobile toggle
                const mobileToggle = document.getElementById('mobile-nav-toggle');
                if (mobileToggle) {
                    mobileToggle.addEventListener('click', () => {
                        const navStepper = document.getElementById('nav-stepper');
                        if (navStepper) {
                            navStepper.classList.toggle('mobile-hidden');
                        }
                    });
                }
                
                // Quick action buttons
                document.getElementById('cheat-sheet-btn')?.addEventListener('click', () => {
                    this.openModal('cheat-sheet-modal');
                });
                
                document.getElementById('notes-btn')?.addEventListener('click', () => {
                    this.openModal('notes-modal');
                });
                
                document.getElementById('dev-panel-btn')?.addEventListener('click', () => {
                    this.openModal('dev-panel-modal');
                });
                
                document.getElementById('dark-mode-toggle')?.addEventListener('click', () => {
                    this.toggleDarkMode();
                });
                
                // Quick start buttons
                document.getElementById('quick-visualize-btn')?.addEventListener('click', () => {
                    this.navigateToSection('visualizer');
                });
                
                document.getElementById('start-learning-btn')?.addEventListener('click', () => {
                    this.navigateToSection('theory');
                });
                
                // Theory navigation
                document.getElementById('theory-prev-btn')?.addEventListener('click', () => {
                    this.navigateToSection('overview');
                });
                
                document.getElementById('theory-next-btn')?.addEventListener('click', () => {
                    this.navigateToSection('sat');
                });
                
                // Collapsible content
                document.querySelectorAll('.collapsible').forEach(item => {
                    item.addEventListener('click', () => {
                        const contentId = item.id.replace('-toggle', '-content');
                        const content = document.getElementById(contentId);
                        const arrow = item.querySelector('span');
                        
                        if (content) {
                            content.classList.toggle('expanded');
                            arrow.textContent = content.classList.contains('expanded') ? '‚ñ≤' : '‚ñº';
                        }
                    });
                });
                
                // Section-specific event listeners will be set up in their respective initialization methods
                this.setupSectionEventListeners();
            },
            
            // Setup section-specific event listeners
            setupSectionEventListeners() {
                // SAT Solver
                document.getElementById('sat-solve-btn')?.addEventListener('click', () => {
                    this.solveSAT();
                });
                
                document.getElementById('sat-clear-btn')?.addEventListener('click', () => {
                    this.clearSAT();
                });
                
                // 3-CNF Converter
                document.getElementById('3cnf-convert-btn')?.addEventListener('click', () => {
                    this.convertTo3CNF();
                });
                
                document.getElementById('3cnf-animate-btn')?.addEventListener('click', () => {
                    this.animate3CNFConversion();
                });
                
                // Reduction
                document.getElementById('reduction-prev-btn-step')?.addEventListener('click', () => {
                    this.previousReductionStep();
                });
                
                document.getElementById('reduction-next-btn-step')?.addEventListener('click', () => {
                    this.nextReductionStep();
                });
                
                document.getElementById('reduction-play-btn')?.addEventListener('click', () => {
                    this.playReduction();
                });
                
                document.getElementById('reduction-reset-btn')?.addEventListener('click', () => {
                    this.resetReduction();
                });
                
                // Visualizer
                document.getElementById('viz-build-btn')?.addEventListener('click', () => {
                    this.buildGraph();
                });
                
                document.getElementById('find-clique-btn')?.addEventListener('click', () => {
                    this.findClique();
                });
                
                document.getElementById('reset-graph-btn')?.addEventListener('click', () => {
                    this.resetGraph();
                });
                
                document.getElementById('auto-layout-btn')?.addEventListener('click', () => {
                    this.autoLayoutGraph();
                });
                
                // Example formulas
                document.querySelectorAll('.example-formula').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const formula = btn.getAttribute('data-formula');
                        document.getElementById('viz-formula-input').value = formula;
                        this.buildGraph();
                    });
                });
                
                // SAT example formulas
                document.querySelectorAll('.example-sat').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const formula = btn.getAttribute('data-formula');
                        if (this.expressionBuilder.isManualMode) {
                            document.getElementById('sat-input').value = formula;
                        } else {
                            document.getElementById('generated-formula').textContent = formula;
                        }
                        this.solveSAT();
                    });
                });
                
                // Initialize hamburger toggle
                document.getElementById('hamburger-toggle')?.addEventListener('click', () => {
                    this.toggleSidebar();
                });
                
                // Toggle button functionality
                document.querySelectorAll('.toggle-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.toggleButton(btn);
                    });
                });
                
                // SAT toggle buttons
                document.getElementById('sat-truth-table-toggle')?.addEventListener('click', () => {
                    this.toggleTruthTable();
                });
                
                document.getElementById('sat-auto-solve-toggle')?.addEventListener('click', () => {
                    this.toggleAutoSolve();
                });
                
                // 3-CNF toggle buttons
                document.getElementById('3cnf-show-all-toggle')?.addEventListener('click', () => {
                    this.toggleShowAllSteps();
                });
                
                document.getElementById('3cnf-auto-play-toggle')?.addEventListener('click', () => {
                    this.toggleAutoPlay();
                });
                
                // Visualizer toggle buttons
                document.getElementById('viz-labels-toggle')?.addEventListener('click', () => {
                    this.toggleGraphLabels();
                });
                
                document.getElementById('viz-edges-toggle')?.addEventListener('click', () => {
                    this.toggleGraphEdges();
                });
                
                document.getElementById('viz-highlight-toggle')?.addEventListener('click', () => {
                    this.toggleHighlightMode();
                });
                
                // Practice toggle buttons
                document.getElementById('practice-hints-toggle')?.addEventListener('click', () => {
                    this.toggleHints();
                });
                
                document.getElementById('practice-auto-check-toggle')?.addEventListener('click', () => {
                    this.toggleAutoCheck();
                });
                
                document.getElementById('practice-timer-toggle')?.addEventListener('click', () => {
                    this.toggleTimerMode();
                });
                
                // Quiz toggle buttons
                document.getElementById('quiz-feedback-toggle')?.addEventListener('click', () => {
                    this.toggleQuizFeedback();
                });
                
                document.getElementById('quiz-instant-check-toggle')?.addEventListener('click', () => {
                    this.toggleInstantCheck();
                });
                
                document.getElementById('quiz-review-toggle')?.addEventListener('click', () => {
                    this.toggleReviewMode();
                });
                
                // Practice
                document.querySelectorAll('.difficulty-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.setDifficulty(btn.getAttribute('data-difficulty'));
                    });
                });
                
                document.getElementById('submit-answer-btn')?.addEventListener('click', () => {
                    this.submitPracticeAnswer();
                });
                
                document.getElementById('hint-btn')?.addEventListener('click', () => {
                    this.showHint();
                });
                
                document.getElementById('skip-btn')?.addEventListener('click', () => {
                    this.skipProblem();
                });
                
                // Quiz
                document.getElementById('start-quiz-btn')?.addEventListener('click', () => {
                    this.startQuiz();
                });
                
                document.getElementById('quiz-submit-answer')?.addEventListener('click', () => {
                    this.submitQuizAnswer();
                });
                
                document.getElementById('retake-quiz-btn')?.addEventListener('click', () => {
                    this.resetQuiz();
                });
                
                document.getElementById('review-answers-btn')?.addEventListener('click', () => {
                    this.reviewQuizAnswers();
                });
                
                // Glossary search
                document.getElementById('glossary-search')?.addEventListener('input', (e) => {
                    this.searchGlossary(e.target.value);
                });
                
                // Navigation buttons - Previous/Next for each section
                document.getElementById('theory-prev-btn')?.addEventListener('click', () => {
                    this.navigateToSection('overview');
                });
                
                document.getElementById('theory-next-btn')?.addEventListener('click', () => {
                    this.navigateToSection('sat');
                });
                
                document.getElementById('sat-prev-btn')?.addEventListener('click', () => {
                    this.navigateToSection('theory');
                });
                
                document.getElementById('sat-next-btn')?.addEventListener('click', () => {
                    this.navigateToSection('3cnf');
                });
                
                document.getElementById('3cnf-prev-btn')?.addEventListener('click', () => {
                    this.navigateToSection('sat');
                });
                
                document.getElementById('3cnf-next-btn')?.addEventListener('click', () => {
                    this.navigateToSection('reduction');
                });
                
                document.getElementById('reduction-prev-btn')?.addEventListener('click', () => {
                    this.navigateToSection('3cnf');
                });
                
                document.getElementById('reduction-next-btn')?.addEventListener('click', () => {
                    this.navigateToSection('visualizer');
                });
                
                document.getElementById('viz-prev-btn')?.addEventListener('click', () => {
                    this.navigateToSection('reduction');
                });
                
                document.getElementById('viz-next-btn')?.addEventListener('click', () => {
                    this.navigateToSection('practice');
                });
                
                document.getElementById('practice-prev-btn')?.addEventListener('click', () => {
                    this.navigateToSection('visualizer');
                });
                
                document.getElementById('practice-next-btn')?.addEventListener('click', () => {
                    this.navigateToSection('quiz');
                });
                
                document.getElementById('quiz-prev-btn')?.addEventListener('click', () => {
                    this.navigateToSection('practice');
                });
                
                document.getElementById('quiz-next-btn')?.addEventListener('click', () => {
                    this.navigateToSection('glossary');
                });
                
                document.getElementById('glossary-prev-btn')?.addEventListener('click', () => {
                    this.navigateToSection('quiz');
                });
                
                document.getElementById('glossary-next-btn')?.addEventListener('click', () => {
                    this.completeLearningPath();
                });
                
                // Expression Builder controls
                document.getElementById('toggle-input-mode')?.addEventListener('click', () => {
                    this.toggleInputMode();
                });
                
                document.getElementById('add-clause-btn')?.addEventListener('click', () => {
                    this.addClause();
                });
                
                document.getElementById('generate-formula-btn')?.addEventListener('click', () => {
                    this.generateFormula();
                });
                
                // Quick action buttons
                document.getElementById('quick-visualize-btn')?.addEventListener('click', () => {
                    this.navigateToSection('visualizer');
                });
                
                document.getElementById('start-learning-btn')?.addEventListener('click', () => {
                    this.navigateToSection('theory');
                });
                
                // Pseudo code panel controls
                document.getElementById('pseudo-code-toggle')?.addEventListener('click', () => {
                    this.togglePseudoCodePanel();
                });
                
                document.getElementById('pseudo-code-close')?.addEventListener('click', () => {
                    this.hidePseudoCodePanel();
                });
            },
            
            // Setup keyboard shortcuts
            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    // Don't trigger shortcuts when typing in inputs
                    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
                    
                    switch(e.key.toLowerCase()) {
                        case 'n':
                            this.navigateToNextSection();
                            break;
                        case 'p':
                            this.navigateToPreviousSection();
                            break;
                        case 'v':
                            this.navigateToSection('visualizer');
                            break;
                        case 'h':
                            this.showHint();
                            break;
                        case 'escape':
                            this.closeAllModals();
                            break;
                    }
                });
            },
            
            // Navigate to next section
            navigateToNextSection() {
                const sections = ['overview', 'theory', 'sat', '3cnf', 'reduction', 'visualizer', 'practice', 'quiz', 'glossary'];
                const currentIndex = sections.indexOf(this.currentSection);
                if (currentIndex < sections.length - 1) {
                    this.navigateToSection(sections[currentIndex + 1]);
                }
            },
            
            // Navigate to previous section
            navigateToPreviousSection() {
                const sections = ['overview', 'theory', 'sat', '3cnf', 'reduction', 'visualizer', 'practice', 'quiz', 'glossary'];
                const currentIndex = sections.indexOf(this.currentSection);
                if (currentIndex > 0) {
                    this.navigateToSection(sections[currentIndex - 1]);
                }
            },
            
            // Toggle dark mode
            toggleDarkMode() {
                this.isDarkMode = !this.isDarkMode;
                document.documentElement.classList.toggle('light');
                localStorage.setItem('dark-mode', this.isDarkMode ? 'dark' : 'light');
            },
            
            // Modal management
            openModal(modalId) {
                document.getElementById(modalId).classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            },
            
            closeModal(modalId) {
                document.getElementById(modalId).classList.add('hidden');
                document.body.style.overflow = 'auto';
            },
            
            closeAllModals() {
                document.querySelectorAll('[id$="-modal"]').forEach(modal => {
                    modal.classList.add('hidden');
                });
                document.body.style.overflow = 'auto';
            },
            
            // Show hint (context-aware)
            showHint() {
                switch(this.currentSection) {
                    case 'practice':
                        this.showPracticeHint();
                        break;
                    case 'quiz':
                        // Quiz hints not implemented
                        break;
                    default:
                        console.log('No hints available for this section');
                }
            },
            
            // =================================================================
            // EXPRESSION BUILDER FUNCTIONALITY
            // =================================================================
            
            initializeExpressionBuilder() {
                // Add initial clauses
                this.addClause();
                this.addClause();
                this.generateFormula();
            },
            
            toggleInputMode() {
                this.expressionBuilder.isManualMode = !this.expressionBuilder.isManualMode;
                const builder = document.getElementById('expression-builder');
                const manual = document.getElementById('manual-input');
                const toggleBtn = document.getElementById('toggle-input-mode');
                
                if (this.expressionBuilder.isManualMode) {
                    builder.classList.add('hidden');
                    manual.classList.remove('hidden');
                    toggleBtn.textContent = 'üîß Switch to Builder';
                } else {
                    builder.classList.remove('hidden');
                    manual.classList.add('hidden');
                    toggleBtn.textContent = '‚å®Ô∏è Switch to Manual Input';
                }
            },
            
            addClause() {
                const clauseId = Date.now();
                const clause = {
                    id: clauseId,
                    literals: [
                        { variable: 'A', negated: false },
                        { variable: 'B', negated: false }
                    ],
                    operator: 'OR'
                };
                
                this.expressionBuilder.clauses.push(clause);
                this.renderClause(clause);
            },
            
            renderClause(clause) {
                const container = document.getElementById('clauses-container');
                const clauseDiv = document.createElement('div');
                clauseDiv.className = 'clause-builder';
                clauseDiv.id = `clause-${clause.id}`;
                
                let literalsHTML = clause.literals.map((lit, idx) => `
                    <div class="literal-group">
                        <label class="flex items-center gap-1">
                            <input type="checkbox" ${lit.negated ? 'checked' : ''} 
                                onchange="app.toggleNegation(${clause.id}, ${idx})"
                                class="w-4 h-4">
                            <span class="text-xs" style="color: var(--text-secondary);">NOT</span>
                        </label>
                        <select onchange="app.updateLiteralVariable(${clause.id}, ${idx}, this.value)"
                            class="flex-1">
                            ${this.expressionBuilder.variables.map(v => 
                                `<option value="${v}" ${lit.variable === v ? 'selected' : ''}>${v}</option>`
                            ).join('')}
                        </select>
                        ${idx > 0 ? `
                            <button onclick="app.removeLiteral(${clause.id}, ${idx})" 
                                class="text-red-500 hover:text-red-700 text-sm px-2">
                                ‚úï
                            </button>
                        ` : ''}
                    </div>
                    ${idx < clause.literals.length - 1 ? `
                        <div class="text-center">
                            <select onchange="app.updateClauseOperator(${clause.id}, this.value)"
                                class="text-xs px-2 py-1">
                                ${this.expressionBuilder.clauseOperators.map(op => 
                                    `<option value="${op}" ${clause.operator === op ? 'selected' : ''}>${op}</option>`
                                ).join('')}
                            </select>
                        </div>
                    ` : ''}
                `).join('');
                
                clauseDiv.innerHTML = `
                    ${this.expressionBuilder.clauses.length > 1 ? `
                        <button class="remove-clause-btn" onclick="app.removeClause(${clause.id})">
                            ‚úï
                        </button>
                    ` : ''}
                    <div class="space-y-2">
                        ${literalsHTML}
                        <button onclick="app.addLiteral(${clause.id})" class="add-literal-btn">
                            + Add Literal
                        </button>
                    </div>
                `;
                
                container.appendChild(clauseDiv);
            },
            
            addLiteral(clauseId) {
                const clause = this.expressionBuilder.clauses.find(c => c.id === clauseId);
                if (clause) {
                    clause.literals.push({ variable: 'A', negated: false });
                    this.refreshClause(clauseId);
                }
            },
            
            removeLiteral(clauseId, literalIdx) {
                const clause = this.expressionBuilder.clauses.find(c => c.id === clauseId);
                if (clause && clause.literals.length > 1) {
                    clause.literals.splice(literalIdx, 1);
                    this.refreshClause(clauseId);
                }
            },
            
            removeClause(clauseId) {
                this.expressionBuilder.clauses = this.expressionBuilder.clauses.filter(c => c.id !== clauseId);
                document.getElementById(`clause-${clauseId}`).remove();
                this.generateFormula();
            },
            
            toggleNegation(clauseId, literalIdx) {
                const clause = this.expressionBuilder.clauses.find(c => c.id === clauseId);
                if (clause) {
                    clause.literals[literalIdx].negated = !clause.literals[literalIdx].negated;
                    this.generateFormula();
                }
            },
            
            updateLiteralVariable(clauseId, literalIdx, variable) {
                const clause = this.expressionBuilder.clauses.find(c => c.id === clauseId);
                if (clause) {
                    clause.literals[literalIdx].variable = variable;
                    this.generateFormula();
                }
            },
            
            updateClauseOperator(clauseId, operator) {
                const clause = this.expressionBuilder.clauses.find(c => c.id === clauseId);
                if (clause) {
                    clause.operator = operator;
                    this.generateFormula();
                }
            },
            
            refreshClause(clauseId) {
                const clauseDiv = document.getElementById(`clause-${clauseId}`);
                if (clauseDiv) {
                    clauseDiv.remove();
                    const clause = this.expressionBuilder.clauses.find(c => c.id === clauseId);
                    if (clause) {
                        this.renderClause(clause);
                    }
                }
                this.generateFormula();
            },
            
            generateFormula() {
                const clauses = this.expressionBuilder.clauses.map(clause => {
                    const literals = clause.literals.map(lit => 
                        (lit.negated ? 'NOT ' : '') + lit.variable
                    );
                    return literals.length > 1 
                        ? `(${literals.join(' ' + clause.operator + ' ')})`
                        : literals[0];
                });
                
                const formula = clauses.join(' AND ');
                document.getElementById('generated-formula').textContent = formula;
                
                // Auto-update manual input if in manual mode
                const manualInput = document.getElementById('sat-input');
                if (manualInput) {
                    manualInput.value = formula;
                }
            },
            
            // =================================================================
            // SAT SOLVER FUNCTIONALITY
            // =================================================================
            
            initializeSATSolver() {
                // Set default formula if empty
                const input = document.getElementById('sat-input');
                if (input && !input.value) {
                    input.value = '(A OR B) AND (NOT A OR C)';
                }
            },
            
            async solveSAT() {
                // Get formula from either builder or manual input
                let formula;
                if (this.expressionBuilder.isManualMode) {
                    const input = document.getElementById('sat-input');
                    if (!input) return;
                    formula = input.value.trim();
                } else {
                    formula = document.getElementById('generated-formula').textContent.trim();
                }
                
                if (!formula) {
                    this.showError('Please enter a Boolean formula');
                    return;
                }
                
                // Show pseudo code panel if not visible
                const panel = document.getElementById('pseudo-code-panel');
                if (panel && !panel.classList.contains('visible')) {
                    this.togglePseudoCodePanel();
                    await this.delay(300);
                }
                
                this.satSolver.isSearching = true;
                this.satSolver.currentFormula = formula;
                
                // Highlight step 1: Parse Formula
                this.highlightPseudoCodeStep(0);
                await this.delay(500);
                
                // Parse formula
                const parsed = this.parseBooleanFormula(formula);
                if (!parsed) {
                    this.showError('Invalid formula syntax');
                    this.satSolver.isSearching = false;
                    return;
                }
                
                // Highlight step 2: Generate Assignments
                this.highlightPseudoCodeStep(1);
                await this.delay(500);
                
                // Highlight step 3: Check Satisfiability
                this.highlightPseudoCodeStep(2);
                await this.delay(500);
                
                // Highlight step 4: Brute Force Search
                this.highlightPseudoCodeStep(3);
                await this.delay(300);
                
                // Solve using brute force
                const result = this.bruteForceSAT(parsed);
                this.displaySATResult(result);
                
                // Mark all steps as completed
                const steps = document.querySelectorAll('.pseudo-code-step');
                steps.forEach(step => {
                    step.classList.add('completed');
                    step.classList.remove('active');
                });
                
                this.satSolver.isSearching = false;
            },
            
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            },
            
            parseBooleanFormula(formula) {
                try {
                    // Simple parser for demonstration
                    // Extract variables
                    const variables = new Set();
                    const cleanFormula = formula.toUpperCase()
                        .replace(/\s+/g, '')
                        .replace(/AND/g, '&&')
                        .replace(/OR/g, '||')
                        .replace(/NOT/g, '!');
                    
                    // Find variables (single letters)
                    const matches = cleanFormula.match(/[A-Z]/g);
                    if (matches) {
                        matches.forEach(match => variables.add(match));
                    }
                    
                    return {
                        formula: cleanFormula,
                        variables: Array.from(variables)
                    };
                } catch (e) {
                    return null;
                }
            },
            
            bruteForceSAT(parsed) {
                const { formula, variables } = parsed;
                const n = variables.length;
                const totalAssignments = Math.pow(2, n);
                let satisfyingAssignments = [];
                
                // Generate all possible assignments
                for (let i = 0; i < totalAssignments; i++) {
                    const assignment = {};
                    
                    // Convert i to binary assignment
                    for (let j = 0; j < n; j++) {
                        assignment[variables[j]] = Boolean((i >> j) & 1);
                    }
                    
                    // Evaluate formula
                    if (this.evaluateFormula(formula, assignment)) {
                        satisfyingAssignments.push(assignment);
                    }
                    
                    // Update progress
                    const progress = Math.round(((i + 1) / totalAssignments) * 100);
                    this.updateSATProgress(progress);
                }
                
                return {
                    isSatisfiable: satisfyingAssignments.length > 0,
                    satisfyingAssignments,
                    totalAssignments
                };
            },
            
            evaluateFormula(formula, assignment) {
                try {
                    // Replace variables with their values
                    let evalFormula = formula;
                    
                    for (const [variable, value] of Object.entries(assignment)) {
                        const regex = new RegExp(`\\b${variable}\\b`, 'g');
                        evalFormula = evalFormula.replace(regex, value);
                    }
                    
                    // Evaluate the formula
                    return eval(evalFormula);
                } catch (e) {
                    return false;
                }
            },
            
            updateSATProgress(progress) {
                const progressBar = document.getElementById('sat-progress');
                const progressText = document.getElementById('sat-progress-text');
                
                if (progressBar) progressBar.style.width = `${progress}%`;
                if (progressText) progressText.textContent = `${progress}%`;
            },
            
            displaySATResult(result) {
                const resultsDiv = document.getElementById('sat-results');
                const outputDiv = document.getElementById('sat-output');
                const assignmentDiv = document.getElementById('sat-assignment');
                
                if (!resultsDiv || !outputDiv || !assignmentDiv) return;
                
                resultsDiv.classList.remove('hidden');
                
                if (result.isSatisfiable) {
                    outputDiv.innerHTML = '<span style="color: #22c55e;">‚úì Formula is SATISFIABLE</span>';
                    
                    const assignment = result.satisfyingAssignments[0];
                    const assignmentText = Object.entries(assignment)
                        .map(([v, val]) => `${v} = ${val ? 'T' : 'F'}`)
                        .join(', ');
                    
                    assignmentDiv.innerHTML = `
                        <strong>Satisfying assignment:</strong> ${assignmentText}<br>
                        <strong>Total satisfying assignments:</strong> ${result.satisfyingAssignments.length}
                    `;
                } else {
                    outputDiv.innerHTML = '<span style="color: #ef4444;">‚úó Formula is UNSATISFIABLE</span>';
                    assignmentDiv.innerHTML = 'No satisfying assignments found.';
                }
                
                // Show truth table for small formulas
                if (result.totalAssignments <= 16) {
                    this.displayTruthTable(result);
                }
            },
            
            displayTruthTable(result) {
                const container = document.getElementById('truth-table-container');
                const tableDiv = document.getElementById('truth-table');
                
                if (!container || !tableDiv) return;
                
                container.classList.remove('hidden');
                
                const { formula, variables } = this.parseBooleanFormula(this.satSolver.currentFormula);
                
                let tableHTML = '<table class="min-w-full text-sm"><thead><tr>';
                
                // Header
                variables.forEach(v => {
                    tableHTML += `<th class="p-2 border" style="border-color: var(--border-color);">${v}</th>`;
                });
                tableHTML += '<th class="p-2 border" style="border-color: var(--border-color);">Formula</th></tr></thead><tbody>';
                
                // Rows
                const n = variables.length;
                for (let i = 0; i < Math.pow(2, n); i++) {
                    tableHTML += '<tr>';
                    
                    const assignment = {};
                    for (let j = 0; j < n; j++) {
                        const value = Boolean((i >> j) & 1);
                        assignment[variables[j]] = value;
                        tableHTML += `<td class="p-2 border text-center" style="border-color: var(--border-color);">${value ? 'T' : 'F'}</td>`;
                    }
                    
                    const result = this.evaluateFormula(formula, assignment);
                    tableHTML += `<td class="p-2 border text-center font-bold" style="border-color: var(--border-color); color: ${result ? '#22c55e' : '#ef4444'};">${result ? 'T' : 'F'}</td>`;
                    tableHTML += '</tr>';
                }
                
                tableHTML += '</tbody></table>';
                tableDiv.innerHTML = tableHTML;
            },
            
            clearSAT() {
                document.getElementById('sat-input').value = '';
                document.getElementById('sat-results').classList.add('hidden');
                document.getElementById('truth-table-container').classList.add('hidden');
                this.updateSATProgress(0);
            },
            
            // =================================================================
            // 3-CNF CONVERSION FUNCTIONALITY
            // =================================================================
            
            initialize3CNFConverter() {
                // Load with example formula
                const formula = '(A OR B) AND (NOT A OR C)';
                document.getElementById('original-formula').textContent = formula;
                this.cnfConverter.originalFormula = formula;
            },
            
            async convertTo3CNF() {
                // Show pseudo code panel if not visible
                const panel = document.getElementById('pseudo-code-panel');
                if (panel && !panel.classList.contains('visible')) {
                    this.togglePseudoCodePanel();
                }
                
                // Highlight steps as conversion progresses
                for (let i = 0; i < 5; i++) {
                    this.highlightPseudoCodeStep(i);
                    await this.delay(400);
                }
                const formula = this.cnfConverter.originalFormula;
                const steps = this.generate3CNFSteps(formula);
                
                this.cnfConverter.conversionSteps = steps;
                this.display3CNFConversion(steps);
            },
            
            generate3CNFSteps(formula) {
                const steps = [];
                
                // Step 1: Parse original formula
                steps.push({
                    title: 'Original Formula',
                    formula: formula,
                    description: 'Starting with the original SAT formula'
                });
                
                // Step 2: Extract clauses
                const clauses = this.parseFormula(formula);
                steps.push({
                    title: 'Extract Clauses',
                    formula: this.clausesToString(clauses),
                    description: `Found ${clauses.length} clauses`
                });
                
                // Step 3: Convert each clause to 3-CNF
                const cnfClauses = clauses.map(clause => this.convertClauseTo3CNF(clause));
                steps.push({
                    title: 'Convert to 3-CNF',
                    formula: this.clausesToString(cnfClauses),
                    description: 'Each clause now has exactly 3 literals'
                });
                
                return steps;
            },
            
            parseFormula(formula) {
                try {
                    const cleaned = formula.toUpperCase().replace(/\s+/g, '');
                    const clauses = cleaned.split('AND')
                        .map(c => c.replace(/[()]/g, ''))
                        .filter(c => c.length > 0)
                        .map(c => c.split('OR').map(l => l.trim()).filter(l => l.length > 0));
                    return clauses;
                } catch (e) {
                    return [];
                }
            },
            
            convertClauseTo3CNF(clause) {
                let result = [...clause];
                
                // If fewer than 3 literals, duplicate the last one
                while (result.length < 3) {
                    result.push(result[result.length - 1]);
                }
                
                // Take first 3 literals
                return result.slice(0, 3);
            },
            
            clausesToString(clauses) {
                return clauses.map(clause => 
                    `(${clause.map(l => l.replace('NOT', '¬¨')).join(' OR ')})`
                ).join(' AND ');
            },
            
            display3CNFConversion(steps) {
                const stepsDiv = document.getElementById('conversion-steps');
                const finalDiv = document.getElementById('final-3cnf');
                
                if (!stepsDiv || !finalDiv) return;
                
                stepsDiv.innerHTML = steps.map((step, index) => `
                    <div class="p-3 rounded-lg" style="background: var(--code-bg);">
                        <h5 class="font-bold mb-1" style="color: var(--text-main);">Step ${index + 1}: ${step.title}</h5>
                        <p class="text-sm mb-2" style="color: var(--text-secondary);">${step.description}</p>
                        <div class="font-mono text-sm">${step.formula}</div>
                    </div>
                `).join('');
                
                finalDiv.textContent = steps[steps.length - 1].formula;
            },
            
            animate3CNFConversion() {
                if (this.cnfConverter.isAnimating) return;
                
                this.cnfConverter.isAnimating = true;
                this.cnfConverter.currentStep = 0;
                
                const steps = this.cnfConverter.conversionSteps;
                if (steps.length === 0) {
                    this.convertTo3CNF();
                }
                
                this.animateStep();
            },
            
            animateStep() {
                const steps = this.cnfConverter.conversionSteps;
                if (this.cnfConverter.currentStep >= steps.length) {
                    this.cnfConverter.isAnimating = false;
                    return;
                }
                
                // Show current step
                const stepsDiv = document.getElementById('conversion-steps');
                const currentStepData = steps[this.cnfConverter.currentStep];
                
                stepsDiv.innerHTML = `
                    <div class="p-3 rounded-lg pulse" style="background: var(--code-bg);">
                        <h5 class="font-bold mb-1" style="color: var(--text-main);">Step ${this.cnfConverter.currentStep + 1}: ${currentStepData.title}</h5>
                        <p class="text-sm mb-2" style="color: var(--text-secondary);">${currentStepData.description}</p>
                        <div class="font-mono text-sm">${currentStepData.formula}</div>
                    </div>
                `;
                
                this.cnfConverter.currentStep++;
                
                // Continue animation after delay
                setTimeout(() => this.animateStep(), 2000);
            },
            
            // =================================================================
            // REDUCTION FUNCTIONALITY
            // =================================================================
            
            initializeReduction() {
                const formula = '(A OR B OR C) AND (NOT A OR D OR E)';
                this.reduction.formula = formula;
                this.reduction.currentStep = 0;
                document.getElementById('reduction-3cnf').textContent = formula;
                this.generateReductionSteps();
            },
            
            generateReductionSteps() {
                this.reduction.steps = [
                    {
                        title: "Step 1: Parse 3-CNF Formula",
                        description: "Extract clauses and literals from the 3-CNF formula",
                        formula: "(A ‚à® B ‚à® C) ‚àß (¬¨A ‚à® D ‚à® E)"
                    },
                    {
                        title: "Step 2: Create Graph Nodes",
                        description: "Create one node for each literal in each clause",
                        formula: "Nodes: A‚ÇÅ, B‚ÇÅ, C‚ÇÅ, ¬¨A‚ÇÇ, D‚ÇÇ, E‚ÇÇ"
                    },
                    {
                        title: "Step 3: Add Edges",
                        description: "Connect nodes from different clauses that don't contradict",
                        formula: "Edges: A‚ÇÅ-D‚ÇÇ, A‚ÇÅ-E‚ÇÇ, B‚ÇÅ-¬¨A‚ÇÇ, B‚ÇÅ-D‚ÇÇ, B‚ÇÅ-E‚ÇÇ, C‚ÇÅ-¬¨A‚ÇÇ, C‚ÇÅ-D‚ÇÇ, C‚ÇÅ-E‚ÇÇ"
                    },
                    {
                        title: "Step 4: Set k = number of clauses",
                        description: "We need to find a clique of size 2 (one node from each clause)",
                        formula: "k = 2"
                    }
                ];
            },
            
            previousReductionStep() {
                if (this.reduction.currentStep > 0) {
                    this.reduction.currentStep--;
                    this.displayReductionStep();
                }
            },
            
            nextReductionStep() {
                if (this.reduction.currentStep < this.reduction.steps.length - 1) {
                    this.reduction.currentStep++;
                    this.displayReductionStep();
                }
            },
            
            playReduction() {
                if (this.reduction.isPlaying) return;
                
                this.reduction.isPlaying = true;
                this.reduction.currentStep = 0;
                
                const animateStep = () => {
                    if (this.reduction.currentStep < this.reduction.steps.length) {
                        this.displayReductionStep();
                        this.reduction.currentStep++;
                        setTimeout(animateStep, 2000);
                    } else {
                        this.reduction.isPlaying = false;
                    }
                };
                
                animateStep();
            },
            
            resetReduction() {
                this.reduction.currentStep = 0;
                this.reduction.isPlaying = false;
                this.displayReductionStep();
            },
            
            displayReductionStep() {
                const step = this.reduction.steps[this.reduction.currentStep];
                const display = document.getElementById('reduction-step-display');
                
                if (display) {
                    display.innerHTML = `
                        <div class="p-4 rounded-lg" style="background: var(--code-bg);">
                            <h5 class="font-bold mb-2" style="color: var(--text-main);">${step.title}</h5>
                            <p class="text-sm mb-2" style="color: var(--text-secondary);">${step.description}</p>
                            <div class="font-mono text-sm">${step.formula}</div>
                        </div>
                    `;
                }
            },
            
            // =================================================================
            // VISUALIZER FUNCTIONALITY
            // =================================================================
            
            initializeVisualizer() {
                // Auto-build with default formula after a short delay
                setTimeout(() => {
                    this.buildGraph();
                }, 500);
            },
            
            buildGraph() {
                const formula = document.getElementById('viz-formula-input').value.trim();
                if (!formula) {
                    this.showError('Please enter a Boolean formula');
                    return;
                }
                
                this.visualizer.currentFormula = formula;
                
                // Parse and convert to 3-CNF
                const clauses = this.convertTo3CNFForGraph(formula);
                this.visualizer.graphData = this.buildCliqueGraph(clauses);
                
                // Create Cytoscape graph
                this.createCytoscapeGraph(this.visualizer.graphData);
            },
            
            convertTo3CNFForGraph(formula) {
                try {
                    const parsed = this.parseFormula(formula);
                    return parsed.map(clause => this.convertClauseTo3CNF(clause));
                } catch (e) {
                    this.showError('Invalid formula syntax');
                    return [];
                }
            },
            
            buildCliqueGraph(clauses) {
                let nodes = [];
                let edges = [];
                
                // Create nodes for each literal in each clause
                clauses.forEach((clause, i) => {
                    clause.forEach(lit => {
                        const nodeId = `${lit}_${i + 1}`;
                        const label = lit.replace('NOT', '¬¨');
                        nodes.push({ 
                            id: nodeId, 
                            label: label, 
                            clause: i + 1,
                            originalLiteral: lit
                        });
                    });
                });
                
                // Build edges between non-contradictory literals from different clauses
                for (let i = 0; i < nodes.length; i++) {
                    for (let j = i + 1; j < nodes.length; j++) {
                        const n1 = nodes[i];
                        const n2 = nodes[j];
                        
                        // Only connect nodes from different clauses that don't contradict
                        if (n1.clause !== n2.clause && !this.areContradictory(n1.originalLiteral, n2.originalLiteral)) {
                            edges.push({ 
                                source: n1.id, 
                                target: n2.id 
                            });
                        }
                    }
                }
                
                return { nodes, edges, k: clauses.length };
            },
            
            areContradictory(literal1, literal2) {
                const l1 = literal1.replace('NOT', '').replace('¬¨', '');
                const l2 = literal2.replace('NOT', '').replace('¬¨', '');
                const neg1 = literal1.startsWith('NOT') || literal1.startsWith('¬¨');
                const neg2 = literal2.startsWith('NOT') || literal2.startsWith('¬¨');
                return l1 === l2 && neg1 !== neg2;
            },
            
            createCytoscapeGraph(graphData) {
                const container = document.getElementById('clique-graph-container');
                if (!container) return;
                
                // Clear previous graph
                container.innerHTML = '';
                
                // Set container size
                container.style.width = '100%';
                container.style.height = '400px';
                container.style.border = '1px solid var(--border-color)';
                container.style.borderRadius = '8px';
                
                // Destroy existing graph
                if (this.visualizer.cy) {
                    this.visualizer.cy.destroy();
                }
                
                try {
                    this.visualizer.cy = cytoscape({
                        container: container,
                        elements: [
                            ...graphData.nodes.map(node => ({ 
                                data: { 
                                    id: node.id, 
                                    label: node.label, 
                                    clause: node.clause 
                                } 
                            })),
                            ...graphData.edges.map(edge => ({ 
                                data: { 
                                    source: edge.source, 
                                    target: edge.target 
                                } 
                            }))
                        ],
                        style: [
                            {
                                selector: 'node',
                                style: {
                                    'background-color': function(ele) {
                                        const colors = ['#ef4444', '#3b82f6', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899'];
                                        return colors[(ele.data('clause') - 1) % colors.length];
                                    },
                                    'label': 'data(label)',
                                    'color': '#fff',
                                    'text-valign': 'center',
                                    'text-halign': 'center',
                                    'font-weight': 'bold',
                                    'font-size': '14px',
                                    'width': 50,
                                    'height': 50,
                                    'border-width': 2,
                                    'border-color': '#fff',
                                    'text-outline-width': 2,
                                    'text-outline-color': '#000'
                                }
                            },
                            {
                                selector: 'edge',
                                style: {
                                    'width': 2,
                                    'line-color': '#4b5563',
                                    'opacity': 0.6,
                                    'curve-style': 'bezier'
                                }
                            },
                            {
                                selector: '.highlighted',
                                style: {
                                    'background-color': '#22c55e',
                                    'border-width': 4,
                                    'width': 60,
                                    'height': 60,
                                    'text-outline-color': '#22c55e'
                                }
                            }
                        ],
                        layout: { 
                            name: 'cose', 
                            padding: 50,
                            animate: true,
                            animationDuration: 1000,
                            idealEdgeLength: 100,
                            nodeOverlap: 20,
                            fit: true
                        }
                    });
                } catch (error) {
                    this.showError('Failed to create graph visualization');
                    console.error('Cytoscape error:', error);
                }
            },
            
            findClique() {
                if (!this.visualizer.cy) {
                    this.showError('Please build a graph first');
                    return;
                }
                
                try {
                    // Simple clique finding (select one node from each clause)
                    const clique = [];
                    const numClauses = Math.max(...this.visualizer.cy.nodes().map(n => n.data('clause')));
                    
                    for (let clause = 1; clause <= numClauses; clause++) {
                        const nodesInClause = this.visualizer.cy.nodes().filter(node => node.data('clause') === clause);
                        if (nodesInClause.length > 0) {
                            clique.push(nodesInClause[0]);
                        }
                    }
                    
                    // Highlight clique
                    this.visualizer.cy.elements().removeClass('highlighted');
                    clique.forEach(node => node.addClass('highlighted'));
                    
                    // Show results
                    const resultsDiv = document.getElementById('clique-results');
                    const outputDiv = document.getElementById('clique-output');
                    
                    if (resultsDiv && outputDiv) {
                        resultsDiv.classList.remove('hidden');
                        
                        const assignment = {};
                        clique.forEach(node => {
                            const label = node.data('label');
                            const variable = label.replace('¬¨', '').replace('NOT', '');
                            const isNegated = label.startsWith('¬¨') || label.includes('NOT');
                            assignment[variable] = !isNegated;
                        });
                        
                        const assignmentText = Object.entries(assignment)
                            .map(([v, t]) => `${v}=${t ? 'T' : 'F'}`)
                            .join(', ');
                        
                        outputDiv.innerHTML = `
                            <div class="space-y-2">
                                <p><span style="color: #22c55e;">‚úì Found satisfying clique of size ${clique.length}</span></p>
                                <p><strong>Assignment:</strong> <code class="text-sm">${assignmentText}</code></p>
                                <p class="text-sm" style="color: var(--text-secondary);">
                                    This assignment makes the original formula true
                                </p>
                            </div>
                        `;
                    }
                } catch (error) {
                    this.showError('Failed to find clique');
                    console.error('Clique finding error:', error);
                }
            },
            
            resetGraph() {
                if (this.visualizer.cy) {
                    this.visualizer.cy.elements().removeClass('highlighted');
                }
                document.getElementById('clique-results').classList.add('hidden');
            },
            
            autoLayoutGraph() {
                if (!this.visualizer.cy) {
                    this.showError('Please build a graph first');
                    return;
                }
                
                try {
                    this.visualizer.cy.layout({
                        name: 'cose',
                        animate: true,
                        animationDuration: 1000,
                        fit: true,
                        padding: 50
                    }).run();
                } catch (error) {
                    this.showError('Failed to reorganize graph');
                    console.error('Layout error:', error);
                }
            },
            
            // =================================================================
            // PRACTICE PROBLEMS FUNCTIONALITY
            // =================================================================
            
            initializePracticeProblems() {
                this.practice.problems = {
                    easy: [
                        {
                            question: "Convert the following formula to 3-CNF: (A OR B) AND (NOT C)",
                            type: "3cnf",
                            answer: "(A OR B OR B) AND (NOT C OR NOT C OR NOT C)",
                            hint: "Remember to pad clauses with fewer than 3 literals by duplicating literals"
                        },
                        {
                            question: "Is the formula (A AND NOT A) satisfiable?",
                            type: "sat",
                            answer: "No, it's a contradiction - always false",
                            hint: "Think about what happens when A is true vs false"
                        },
                        {
                            question: "How many variables are in the formula: (X OR Y) AND (NOT X OR Z)?",
                            type: "count",
                            answer: "3 variables: X, Y, Z",
                            hint: "Count each unique variable, ignoring NOT operators"
                        }
                    ],
                    medium: [
                        {
                            question: "Convert to 3-CNF: (A OR B OR C OR D) AND (E)",
                            type: "3cnf",
                            answer: "(A OR B OR C) AND (C OR D OR D) AND (E OR E OR E)",
                            hint: "Break down clauses with more than 3 literals and pad shorter ones"
                        },
                        {
                            question: "Is the formula (A OR NOT A) satisfiable? Explain why.",
                            type: "sat",
                            answer: "Yes, it's a tautology - always true regardless of A's value",
                            hint: "Think about what happens when A is true vs false"
                        },
                        {
                            question: "Find a satisfying assignment for: (A OR B) AND (NOT A OR C)",
                            type: "assignment",
                            answer: "A=true, B=false, C=true",
                            hint: "Try different values for A and see what constraints that creates"
                        },
                        {
                            question: "What is the size of the largest clique in a triangle graph?",
                            type: "graph",
                            answer: "3 (the entire triangle is a clique)",
                            hint: "A clique is a complete subgraph where all vertices are connected"
                        }
                    ],
                    hard: [
                        {
                            question: "Prove that CLIQUE is NP-complete",
                            type: "proof",
                            answer: "Reduce 3-SAT to CLIQUE by constructing graph where satisfiability corresponds to k-clique",
                            hint: "Start with the 3-SAT ‚Üí CLIQUE reduction we learned"
                        },
                        {
                            question: "Convert to 3-CNF and find satisfying assignment: (A OR B OR C) AND (NOT A OR NOT B) AND (A OR NOT C)",
                            type: "complex",
                            answer: "3-CNF: (A OR B OR C) AND (NOT A OR NOT B OR NOT B) AND (A OR NOT C OR NOT C). Assignment: A=true, B=false, C=false",
                            hint: "First convert to 3-CNF, then test assignments systematically"
                        },
                        {
                            question: "If a formula has n variables, what's the maximum number of satisfying assignments?",
                            type: "theory",
                            answer: "2^n (when the formula is a tautology)",
                            hint: "Each variable can be true or false independently"
                        }
                    ]
                };
            },
            
            loadPracticeProblem() {
                const problems = this.practice.problems[this.practice.difficulty];
                const problem = problems[this.practice.currentProblem % problems.length];
                
                document.getElementById('problem-number').textContent = this.practice.currentProblem + 1;
                document.getElementById('total-problems').textContent = problems.length;
                document.getElementById('problem-description').textContent = problem.question;
                
                // Create input area based on problem type
                this.createProblemInputArea(problem);
            },
            
            createProblemInputArea(problem) {
                const inputArea = document.getElementById('problem-input-area');
                
                switch(problem.type) {
                    case '3cnf':
                    case 'sat':
                    case 'complex':
                        inputArea.innerHTML = `
                            <div class="mb-3">
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-main);">Your Answer:</label>
                                <textarea class="w-full p-3 rounded-lg border font-mono text-sm" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);" 
                                    rows="3" placeholder="Enter your answer..."></textarea>
                            </div>
                            <div class="text-xs" style="color: var(--text-secondary);">
                                <strong>Examples:</strong><br>
                                ‚Ä¢ 3-CNF: (A OR B OR C) AND (NOT D OR E OR F)<br>
                                ‚Ä¢ SAT: Yes/No with explanation
                            </div>
                        `;
                        break;
                    case 'assignment':
                        inputArea.innerHTML = `
                            <div class="mb-3">
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-main);">Assignment (format: A=true, B=false):</label>
                                <input type="text" class="w-full p-3 rounded-lg border font-mono text-sm" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);" 
                                    placeholder="e.g., A=true, B=false, C=true">
                            </div>
                            <div class="text-xs" style="color: var(--text-secondary);">
                                <strong>Example:</strong> A=true, B=false, C=true
                            </div>
                        `;
                        break;
                    case 'count':
                        inputArea.innerHTML = `
                            <div class="mb-3">
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-main);">Number of variables:</label>
                                <input type="number" class="w-full p-3 rounded-lg border font-mono text-sm" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);" 
                                    placeholder="Enter number" min="1">
                            </div>
                            <div class="text-xs" style="color: var(--text-secondary);">
                                <strong>Example:</strong> 3
                            </div>
                        `;
                        break;
                    case 'graph':
                        inputArea.innerHTML = `
                            <div class="mb-3">
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-main);">Clique size:</label>
                                <input type="number" class="w-full p-3 rounded-lg border font-mono text-sm" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);" 
                                    placeholder="Enter size" min="1">
                            </div>
                            <div class="text-xs" style="color: var(--text-secondary);">
                                <strong>Example:</strong> 3 (for triangle)
                            </div>
                        `;
                        break;
                    case 'theory':
                    case 'proof':
                        inputArea.innerHTML = `
                            <div class="mb-3">
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-main);">Your explanation:</label>
                                <textarea class="w-full p-3 rounded-lg border font-mono text-sm" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);" 
                                    rows="6" placeholder="Write your explanation..."></textarea>
                            </div>
                            <div class="text-xs" style="color: var(--text-secondary);">
                                <strong>Tip:</strong> Explain your reasoning step by step
                            </div>
                        `;
                        break;
                    default:
                        inputArea.innerHTML = `
                            <div class="mb-3">
                                <label class="block text-sm font-medium mb-2" style="color: var(--text-main);">Your answer:</label>
                                <input type="text" class="w-full p-3 rounded-lg border font-mono text-sm" style="background: var(--code-bg); border-color: var(--border-color); color: var(--text-main);" 
                                    placeholder="Enter your answer...">
                            </div>
                        `;
                }
            },
            
            setDifficulty(difficulty) {
                this.practice.difficulty = difficulty;
                this.practice.currentProblem = 0;
                this.practice.hintsShown = 0;
                
                // Update button styles
                document.querySelectorAll('.difficulty-btn').forEach(btn => {
                    if (btn.getAttribute('data-difficulty') === difficulty) {
                        btn.classList.remove('btn-secondary');
                        btn.classList.add('btn-primary');
                    } else {
                        btn.classList.remove('btn-primary');
                        btn.classList.add('btn-secondary');
                    }
                });
                
                this.loadPracticeProblem();
            },
            
            submitPracticeAnswer() {
                const problems = this.practice.problems[this.practice.difficulty];
                const problem = problems[this.practice.currentProblem % problems.length];
                const userAnswer = document.querySelector('#problem-input-area input, #problem-input-area textarea').value.trim();
                
                if (!userAnswer) {
                    this.showError('Please provide an answer');
                    return;
                }
                
                const feedbackDiv = document.getElementById('feedback');
                const feedbackText = document.getElementById('feedback-text');
                
                feedbackDiv.classList.remove('hidden');
                
                // Simple answer checking (case-insensitive)
                const isCorrect = userAnswer.toLowerCase().includes(problem.answer.toLowerCase()) ||
                                 problem.answer.toLowerCase().includes(userAnswer.toLowerCase());
                
                if (isCorrect) {
                    feedbackDiv.style.backgroundColor = 'rgba(34, 197, 94, 0.1)';
                    feedbackDiv.style.borderColor = '#22c55e';
                    feedbackText.textContent = '‚úì Correct! Well done.';
                    feedbackText.style.color = '#22c55e';
                } else {
                    feedbackDiv.style.backgroundColor = 'rgba(239, 68, 68, 0.1)';
                    feedbackDiv.style.borderColor = '#ef4444';
                    feedbackText.textContent = `‚úó Incorrect. The expected answer is: ${problem.answer}`;
                    feedbackText.style.color = '#ef4444';
                }
            },
            
            showPracticeHint() {
                const problems = this.practice.problems[this.practice.difficulty];
                const problem = problems[this.practice.currentProblem % problems.length];
                
                const hintDiv = document.getElementById('hint-display');
                const hintText = document.getElementById('hint-text');
                
                hintDiv.classList.remove('hidden');
                hintText.textContent = problem.hint;
                
                this.practice.hintsShown++;
            },
            
            skipProblem() {
                this.practice.currentProblem++;
                this.practice.hintsShown = 0;
                document.getElementById('feedback').classList.add('hidden');
                document.getElementById('hint-display').classList.add('hidden');
                this.loadPracticeProblem();
            },
            
            // =================================================================
            // QUIZ FUNCTIONALITY
            // =================================================================
            
            initializeQuizQuestions() {
                this.quiz.questions = [
                    {
                        question: "Which class contains problems that can be solved in polynomial time?",
                        options: ["P", "NP", "NP-hard", "NP-complete"],
                        correct: 0
                    },
                    {
                        question: "A problem is NP-complete if it is:",
                        options: [
                            "In NP and NP-hard",
                            "Only in NP",
                            "Only NP-hard",
                            "Neither in NP nor NP-hard"
                        ],
                        correct: 0
                    },
                    {
                        question: "The Cook-Levin theorem proved that which problem is NP-complete?",
                        options: ["SAT", "CLIQUE", "Vertex Cover", "Hamiltonian Cycle"],
                        correct: 0
                    },
                    {
                        question: "In 3-CNF, each clause must have exactly:",
                        options: ["3 literals", "2 literals", "4 literals", "5 literals"],
                        correct: 0
                    },
                    {
                        question: "A clique is a:",
                        options: [
                            "Complete subgraph",
                            "Path in a graph",
                            "Tree structure",
                            "Directed graph"
                        ],
                        correct: 0
                    }
                ];
            },
            
            startQuiz() {
                const length = parseInt(document.getElementById('quiz-length').value);
                const timeLimit = parseInt(document.getElementById('quiz-timer').value);
                
                this.quiz.currentQuestion = 0;
                this.quiz.score = 0;
                this.quiz.answers = [];
                this.quiz.timeLimit = timeLimit;
                
                // Select random questions
                this.quiz.questions = this.shuffleArray([...this.quiz.questions]).slice(0, length);
                
                // Start timer if needed
                if (timeLimit > 0) {
                    this.startQuizTimer(timeLimit);
                }
                
                // Show quiz content
                document.getElementById('quiz-content').classList.remove('hidden');
                document.getElementById('quiz-results').classList.add('hidden');
                
                this.loadQuizQuestion();
            },
            
            loadQuizQuestion() {
                const question = this.quiz.questions[this.quiz.currentQuestion];
                
                document.getElementById('quiz-question-number').textContent = this.quiz.currentQuestion + 1;
                document.getElementById('quiz-total-questions').textContent = this.quiz.questions.length;
                document.getElementById('quiz-score').textContent = this.quiz.score;
                
                document.getElementById('quiz-question').textContent = question.question;
                
                const optionsDiv = document.getElementById('quiz-options');
                optionsDiv.innerHTML = question.options.map((option, index) => `
                    <div class="quiz-option" data-index="${index}">
                        <label class="cursor-pointer flex items-center">
                            <input type="radio" name="quiz-answer" value="${index}" class="mr-3">
                            <span>${option}</span>
                        </label>
                    </div>
                `).join('');
                
                // Update progress
                const progress = ((this.quiz.currentQuestion + 1) / this.quiz.questions.length) * 100;
                document.getElementById('quiz-progress').style.width = `${progress}%`;
                
                // Add click handlers
                document.querySelectorAll('.quiz-option').forEach(option => {
                    option.addEventListener('click', () => {
                        document.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
                        option.classList.add('selected');
                        option.querySelector('input').checked = true;
                    });
                });
            },
            
            submitQuizAnswer() {
                const selected = document.querySelector('input[name="quiz-answer"]:checked');
                if (!selected) {
                    this.showError('Please select an answer');
                    return;
                }
                
                const answer = parseInt(selected.value);
                const question = this.quiz.questions[this.quiz.currentQuestion];
                
                this.quiz.answers.push(answer);
                
                if (answer === question.correct) {
                    this.quiz.score++;
                }
                
                // Show feedback
                document.querySelectorAll('.quiz-option').forEach((option, index) => {
                    if (index === question.correct) {
                        option.classList.add('correct');
                    } else if (index === answer && answer !== question.correct) {
                        option.classList.add('incorrect');
                    }
                });
                
                // Move to next question or show results
                setTimeout(() => {
                    this.quiz.currentQuestion++;
                    if (this.quiz.currentQuestion < this.quiz.questions.length) {
                        this.loadQuizQuestion();
                    } else {
                        this.showQuizResults();
                    }
                }, 2000);
            },
            
            startQuizTimer(seconds) {
                let timeLeft = seconds;
                
                this.quiz.timer = setInterval(() => {
                    timeLeft--;
                    
                    const minutes = Math.floor(timeLeft / 60);
                    const secs = timeLeft % 60;
                    document.getElementById('quiz-timer-display').textContent = 
                        `${minutes}:${secs.toString().padStart(2, '0')}`;
                    
                    if (timeLeft <= 0) {
                        this.showQuizResults();
                    }
                }, 1000);
            },
            
            showQuizResults() {
                if (this.quiz.timer) {
                    clearInterval(this.quiz.timer);
                }
                
                document.getElementById('quiz-content').classList.add('hidden');
                document.getElementById('quiz-results').classList.remove('hidden');
                
                const percentage = Math.round((this.quiz.score / this.quiz.questions.length) * 100);
                
                document.getElementById('final-score').textContent = percentage;
                document.getElementById('correct-answers').textContent = this.quiz.score;
                document.getElementById('total-quiz-questions').textContent = this.quiz.questions.length;
                
                // Save to localStorage
                this.saveQuizScore(percentage);
            },
            
            saveQuizScore(score) {
                const scores = JSON.parse(localStorage.getItem('quiz-scores') || '[]');
                scores.push({
                    score: score,
                    date: new Date().toISOString(),
                    difficulty: 'medium'
                });
                localStorage.setItem('quiz-scores', JSON.stringify(scores));
            },
            
            resetQuiz() {
                document.getElementById('quiz-content').classList.add('hidden');
                document.getElementById('quiz-results').classList.add('hidden');
                this.quiz.currentQuestion = 0;
                this.quiz.score = 0;
                this.quiz.answers = [];
                if (this.quiz.timer) {
                    clearInterval(this.quiz.timer);
                }
            },
            
            reviewQuizAnswers() {
                // Create a simple review of answers
                let reviewHTML = '<div class="space-y-4">';
                
                this.quiz.questions.forEach((question, index) => {
                    const userAnswer = this.quiz.answers[index];
                    const isCorrect = userAnswer === question.correct;
                    
                    reviewHTML += `
                        <div class="p-4 rounded-lg" style="background: var(--code-bg);">
                            <p class="font-bold mb-2" style="color: var(--text-main);">Question ${index + 1}:</p>
                            <p class="mb-2" style="color: var(--text-secondary);">${question.question}</p>
                            <p class="${isCorrect ? 'text-green-500' : 'text-red-500'}">
                                Your answer: ${question.options[userAnswer] || 'Not answered'}
                            </p>
                            ${!isCorrect ? `<p class="text-green-500">Correct: ${question.options[question.correct]}</p>` : ''}
                        </div>
                    `;
                });
                
                reviewHTML += '</div>';
                
                // Show review in modal
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
                modal.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 rounded-lg max-w-4xl max-h-[80vh] overflow-y-auto p-6">
                        <h2 class="text-2xl font-bold mb-4">Quiz Review</h2>
                        ${reviewHTML}
                        <button class="btn-secondary mt-4" onclick="this.parentElement.parentElement.remove()">Close</button>
                    </div>
                `;
                document.body.appendChild(modal);
            },
            
            completeLearningPath() {
                // Show completion message
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
                modal.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 rounded-lg max-w-2xl p-6 text-center">
                        <div class="text-6xl mb-4">üéâ</div>
                        <h2 class="text-3xl font-bold mb-4" style="color: var(--primary-indigo);">Congratulations!</h2>
                        <p class="text-lg mb-6" style="color: var(--text-secondary);">
                            You've completed the NP-Completeness Learning Path!
                        </p>
                        <div class="mb-6">
                            <p class="text-sm" style="color: var(--text-secondary);">
                                Progress: ${this.progress}%<br>
                                Sections Completed: ${this.completedSections.size}/9
                            </p>
                        </div>
                        <div class="flex gap-2 justify-center">
                            <button class="btn-primary" onclick="app.navigateToSection('overview'); this.parentElement.parentElement.parentElement.remove()">
                                Start Over
                            </button>
                            <button class="btn-secondary" onclick="this.parentElement.parentElement.parentElement.remove()">
                                Close
                            </button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            },
            
            shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            },
            
            // =================================================================
            // GLOSSARY FUNCTIONALITY
            // =================================================================
            
            searchGlossary(query) {
                const terms = document.querySelectorAll('.card');
                const lowerQuery = query.toLowerCase();
                
                terms.forEach(term => {
                    const text = term.textContent.toLowerCase();
                    if (text.includes(lowerQuery) || query === '') {
                        term.style.display = 'block';
                    } else {
                        term.style.display = 'none';
                    }
                });
            },
            
            // =================================================================
            // UTILITY FUNCTIONS
            // =================================================================
            
            showError(message) {
                // Create a toast notification instead of alert
                const toast = document.createElement('div');
                toast.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-pulse';
                toast.textContent = message;
                document.body.appendChild(toast);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    toast.remove();
                }, 3000);
            },
            
            // Initialize section with error handling
            initializeSection(sectionId) {
                try {
                    switch(sectionId) {
                        case 'sat':
                            this.initializeSATSolver();
                            break;
                        case '3cnf':
                            this.initialize3CNFConverter();
                            break;
                        case 'reduction':
                            this.initializeReduction();
                            break;
                        case 'visualizer':
                            this.initializeVisualizer();
                            break;
                        case 'practice':
                            this.loadPracticeProblem();
                            break;
                        case 'quiz':
                            this.initializeQuiz();
                            break;
                    }
                } catch (error) {
                    console.error(`Error initializing section ${sectionId}:`, error);
                    this.showError(`Failed to load ${sectionId} section`);
                }
            },
            
            // Initialize quiz section
            initializeQuiz() {
                // Quiz is initialized on demand when start button is clicked
                // This is just a placeholder for any setup needed
                console.log('Quiz section initialized');
            },
            
            // =================================================================
            // TOGGLE FUNCTIONALITY
            // =================================================================
            
            toggleButton(button) {
                const currentState = button.getAttribute('data-state');
                const newState = currentState === 'on' ? 'off' : 'on';
                button.setAttribute('data-state', newState);
            },
            
            // SAT Solver toggles
            toggleTruthTable() {
                this.satSolver.showTruthTable = !this.satSolver.showTruthTable;
                const truthTable = document.getElementById('truth-table');
                if (truthTable) {
                    truthTable.style.display = this.satSolver.showTruthTable ? 'block' : 'none';
                }
            },
            
            toggleAutoSolve() {
                this.satSolver.autoSolve = !this.satSolver.autoSolve;
                if (this.satSolver.autoSolve) {
                    this.setupAutoSolve();
                } else {
                    this.stopAutoSolve();
                }
            },
            
            setupAutoSolve() {
                // Get formula from either builder or manual input
                let formula;
                if (this.expressionBuilder.isManualMode) {
                    const input = document.getElementById('sat-input');
                    if (!input) return;
                    formula = input.value.trim();
                } else {
                    formula = document.getElementById('generated-formula').textContent.trim();
                }
                const input = document.getElementById('sat-input');
                if (input) {
                    input.addEventListener('input', this.autoSolveHandler);
                }
            },
            
            stopAutoSolve() {
                const input = document.getElementById('sat-input');
                if (input) {
                    input.removeEventListener('input', this.autoSolveHandler);
                }
            },
            
            autoSolveHandler() {
                clearTimeout(app.autoSolveTimeout);
                app.autoSolveTimeout = setTimeout(() => {
                    if (app.satSolver.autoSolve) {
                        app.solveSAT();
                    }
                }, 1000);
            },
            
            // 3-CNF toggles
            toggleShowAllSteps() {
                this.cnfConverter.showAllSteps = !this.cnfConverter.showAllSteps;
                const steps = document.getElementById('conversion-steps');
                if (steps && this.cnfConverter.conversionSteps.length > 0) {
                    if (this.cnfConverter.showAllSteps) {
                        steps.innerHTML = this.cnfConverter.conversionSteps.map(step => `
                            <div class="p-3 rounded-lg" style="background: var(--code-bg);">
                                <div class="font-mono text-sm">${step}</div>
                            </div>
                        `).join('');
                    } else {
                        this.displayStep(this.cnfConverter.currentStep);
                    }
                }
            },
            
            toggleAutoPlay() {
                this.cnfConverter.autoPlay = !this.cnfConverter.autoPlay;
                if (this.cnfConverter.autoPlay) {
                    this.startAutoPlay();
                } else {
                    this.stopAutoPlay();
                }
            },
            
            startAutoPlay() {
                this.cnfConverter.currentStep = 0;
                this.autoPlayInterval = setInterval(() => {
                    if (this.cnfConverter.currentStep < this.cnfConverter.conversionSteps.length) {
                        this.displayStep(this.cnfConverter.currentStep);
                        this.cnfConverter.currentStep++;
                    } else {
                        this.stopAutoPlay();
                        document.getElementById('3cnf-auto-play-toggle').setAttribute('data-state', 'off');
                    }
                }, 2000);
            },
            
            stopAutoPlay() {
                if (this.autoPlayInterval) {
                    clearInterval(this.autoPlayInterval);
                }
            },
            
            // Visualizer toggles
            toggleGraphLabels() {
                this.visualizer.showLabels = !this.visualizer.showLabels;
                if (this.visualizer.cy) {
                    this.visualizer.cy.style()
                        .selector('node')
                        .style('label', this.visualizer.showLabels ? 'data(label)' : '')
                        .update();
                }
            },
            
            toggleGraphEdges() {
                this.visualizer.showEdges = !this.visualizer.showEdges;
                if (this.visualizer.cy) {
                    this.visualizer.cy.style()
                        .selector('edge')
                        .style('display', this.visualizer.showEdges ? 'element' : 'none')
                        .update();
                }
            },
            
            toggleHighlightMode() {
                this.visualizer.highlightMode = !this.visualizer.highlightMode;
                if (this.visualizer.cy) {
                    if (this.visualizer.highlightMode) {
                        this.visualizer.cy.on('tap', 'node', this.highlightNodeHandler);
                    } else {
                        this.visualizer.cy.off('tap', 'node', this.highlightNodeHandler);
                        this.visualizer.cy.elements().removeClass('highlighted');
                    }
                }
            },
            
            highlightNodeHandler(evt) {
                const node = evt.target;
                node.toggleClass('highlighted');
            },
            
            // Practice toggles
            toggleHints() {
                this.practice.showHints = !this.practice.showHints;
                const hintBtn = document.getElementById('hint-btn');
                if (hintBtn) {
                    hintBtn.style.display = this.practice.showHints ? 'inline-block' : 'none';
                }
                const hintDisplay = document.getElementById('hint-display');
                if (hintDisplay && !this.practice.showHints) {
                    hintDisplay.classList.add('hidden');
                }
            },
            
            toggleAutoCheck() {
                this.practice.autoCheck = !this.practice.autoCheck;
                if (this.practice.autoCheck) {
                    this.setupAutoCheck();
                } else {
                    this.stopAutoCheck();
                }
            },
            
            setupAutoCheck() {
                const inputs = document.querySelectorAll('#problem-input-area input, #problem-input-area textarea');
                inputs.forEach(input => {
                    input.addEventListener('input', this.autoCheckHandler);
                });
            },
            
            stopAutoCheck() {
                const inputs = document.querySelectorAll('#problem-input-area input, #problem-input-area textarea');
                inputs.forEach(input => {
                    input.removeEventListener('input', this.autoCheckHandler);
                });
            },
            
            autoCheckHandler() {
                if (app.practice.autoCheck) {
                    clearTimeout(app.autoCheckTimeout);
                    app.autoCheckTimeout = setTimeout(() => {
                        app.checkPracticeAnswer();
                    }, 2000);
                }
            },
            
            toggleTimerMode() {
                this.practice.timerMode = !this.practice.timerMode;
                if (this.practice.timerMode) {
                    this.startPracticeTimer();
                } else {
                    this.stopPracticeTimer();
                }
            },
            
            startPracticeTimer() {
                this.practice.startTime = Date.now();
                this.practiceTimerInterval = setInterval(() => {
                    const elapsed = Math.floor((Date.now() - this.practice.startTime) / 1000);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = elapsed % 60;
                    // Update timer display if needed
                }, 1000);
            },
            
            stopPracticeTimer() {
                if (this.practiceTimerInterval) {
                    clearInterval(this.practiceTimerInterval);
                }
            },
            
            // Quiz toggles
            toggleQuizFeedback() {
                this.quiz.showFeedback = !this.quiz.showFeedback;
            },
            
            toggleInstantCheck() {
                this.quiz.instantCheck = !this.quiz.instantCheck;
                if (this.quiz.instantCheck) {
                    this.setupInstantCheck();
                } else {
                    this.stopInstantCheck();
                }
            },
            
            setupInstantCheck() {
                const options = document.querySelectorAll('input[name="quiz-option"]');
                options.forEach(option => {
                    option.addEventListener('change', this.instantCheckHandler);
                });
            },
            
            stopInstantCheck() {
                const options = document.querySelectorAll('input[name="quiz-option"]');
                options.forEach(option => {
                    option.removeEventListener('change', this.instantCheckHandler);
                });
            },
            
            instantCheckHandler() {
                if (app.quiz.instantCheck) {
                    // Provide immediate feedback for selected answer
                    const selected = document.querySelector('input[name="quiz-option"]:checked');
                    if (selected) {
                        const isCorrect = parseInt(selected.value) === app.quiz.questions[app.quiz.currentQuestion].correct;
                        // Show immediate feedback
                    }
                }
            },
            
            toggleReviewMode() {
                this.quiz.reviewMode = !this.quiz.reviewMode;
                // Enable/disable review features
            },
            
            // =================================================================
            // PSEUDO CODE PANEL FUNCTIONS
            // =================================================================
            
            togglePseudoCodePanel() {
                const panel = document.getElementById('pseudo-code-panel');
                if (panel) {
                    panel.classList.toggle('visible');
                    if (panel.classList.contains('visible')) {
                        this.updatePseudoCodeForCurrentSection();
                    }
                }
            },
            
            hidePseudoCodePanel() {
                const panel = document.getElementById('pseudo-code-panel');
                if (panel) {
                    panel.classList.remove('visible');
                }
            },
            
            updatePseudoCodeForCurrentSection() {
                const content = document.getElementById('pseudo-code-content');
                if (!content) return;
                
                let steps = [];
                
                switch(this.currentSection) {
                    case 'sat':
                        steps = this.getSATPseudoCode();
                        break;
                    case '3cnf':
                        steps = this.get3CNFPseudoCode();
                        break;
                    case 'reduction':
                        steps = this.getReductionPseudoCode();
                        break;
                    case 'visualizer':
                        steps = this.getCliquePseudoCode();
                        break;
                    default:
                        steps = [{
                            number: 1,
                            code: '// Select a section to see algorithm steps',
                            description: 'Navigate to SAT Solver, 3-CNF, Reduction, or Visualizer to see pseudo code'
                        }];
                }
                
                this.renderPseudoCodeSteps(steps);
            },
            
            renderPseudoCodeSteps(steps) {
                const content = document.getElementById('pseudo-code-content');
                if (!content) return;
                
                content.innerHTML = steps.map((step, index) => `
                    <div class="pseudo-code-step ${index === 0 ? 'active' : ''}" data-step="${index}">
                        <div>
                            <span class="step-number">${step.number}</span>
                            <span style="color: var(--text-main); font-weight: 600;">${step.title || `Step ${step.number}`}</span>
                        </div>
                        <div class="step-code">${this.escapeHtml(step.code)}</div>
                        ${step.description ? `<div class="step-description">${step.description}</div>` : ''}
                    </div>
                `).join('');
            },
            
            highlightPseudoCodeStep(stepIndex) {
                const steps = document.querySelectorAll('.pseudo-code-step');
                steps.forEach((step, index) => {
                    step.classList.remove('active', 'completed');
                    if (index < stepIndex) {
                        step.classList.add('completed');
                    } else if (index === stepIndex) {
                        step.classList.add('active');
                        step.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }
                });
            },
            
            getSATPseudoCode() {
                return [
                    {
                        number: 1,
                        title: 'Parse Formula',
                        code: 'function parseFormula(formula):\n    variables = extractVariables(formula)\n    clauses = parseClauses(formula)\n    return {variables, clauses}',
                        description: 'Extract all variables and parse the formula into clauses'
                    },
                    {
                        number: 2,
                        title: 'Generate Assignments',
                        code: 'function generateAssignments(variables):\n    n = variables.length\n    assignments = []\n    for i = 0 to 2^n - 1:\n        assignment = binaryRepresentation(i, n)\n        assignments.append(assignment)\n    return assignments',
                        description: 'Generate all possible truth value assignments (2^n combinations)'
                    },
                    {
                        number: 3,
                        title: 'Check Satisfiability',
                        code: 'function checkSatisfiability(clauses, assignment):\n    for each clause in clauses:\n        clauseSatisfied = false\n        for each literal in clause:\n            if evaluateLiteral(literal, assignment):\n                clauseSatisfied = true\n                break\n        if not clauseSatisfied:\n            return false\n    return true',
                        description: 'Check if the assignment satisfies all clauses'
                    },
                    {
                        number: 4,
                        title: 'Brute Force Search',
                        code: 'function bruteForceSAT(formula):\n    parsed = parseFormula(formula)\n    assignments = generateAssignments(parsed.variables)\n    for each assignment in assignments:\n        if checkSatisfiability(parsed.clauses, assignment):\n            return {satisfiable: true, assignment}\n    return {satisfiable: false}',
                        description: 'Try all possible assignments until finding a satisfying one or exhausting all possibilities'
                    }
                ];
            },
            
            get3CNFPseudoCode() {
                return [
                    {
                        number: 1,
                        title: 'Parse Original Formula',
                        code: 'function parseToCNF(formula):\n    clauses = extractClauses(formula)\n    return clauses',
                        description: 'Parse the input formula into CNF clauses'
                    },
                    {
                        number: 2,
                        title: 'Handle Single Literal Clauses',
                        code: 'function handleSingleLiteral(clause):\n    if clause.length == 1:\n        literal = clause[0]\n        return [(literal, literal, literal)]\n    return clause',
                        description: 'Convert single literal clauses to 3-CNF by duplicating the literal'
                    },
                    {
                        number: 3,
                        title: 'Handle Two Literal Clauses',
                        code: 'function handleTwoLiterals(clause):\n    if clause.length == 2:\n        l1, l2 = clause\n        newVar = createNewVariable()\n        return [(l1, l2, newVar), (l1, l2, NOT newVar)]\n    return clause',
                        description: 'Convert two literal clauses using a new variable'
                    },
                    {
                        number: 4,
                        title: 'Handle Long Clauses',
                        code: 'function handleLongClause(clause):\n    if clause.length > 3:\n        result = []\n        for i = 0 to clause.length - 3:\n            newVar = createNewVariable()\n            result.append((clause[i], newVar, NOT newVar))\n        result.append((clause[-3], clause[-2], clause[-1]))\n        return result\n    return clause',
                        description: 'Break down clauses with more than 3 literals into multiple 3-literal clauses'
                    },
                    {
                        number: 5,
                        title: 'Combine Results',
                        code: 'function convertTo3CNF(formula):\n    clauses = parseToCNF(formula)\n    result = []\n    for each clause in clauses:\n        if clause.length == 1:\n            result.extend(handleSingleLiteral(clause))\n        else if clause.length == 2:\n            result.extend(handleTwoLiterals(clause))\n        else if clause.length > 3:\n            result.extend(handleLongClause(clause))\n        else:\n            result.append(clause)\n    return result',
                        description: 'Combine all converted clauses into final 3-CNF form'
                    }
                ];
            },
            
            getReductionPseudoCode() {
                return [
                    {
                        number: 1,
                        title: 'Parse 3-SAT Formula',
                        code: 'function parse3SAT(formula):\n    clauses = extract3CNFClauses(formula)\n    return clauses',
                        description: 'Parse the 3-SAT formula into clauses with exactly 3 literals each'
                    },
                    {
                        number: 2,
                        title: 'Create Graph Vertices',
                        code: 'function createVertices(clauses):\n    vertices = []\n    for each clause in clauses:\n        for each literal in clause:\n            vertex = {clause: clause.id, literal: literal}\n            vertices.append(vertex)\n    return vertices',
                        description: 'Create a vertex for each literal in each clause'
                    },
                    {
                        number: 3,
                        title: 'Create Graph Edges',
                        code: 'function createEdges(vertices, clauses):\n    edges = []\n    for i = 0 to vertices.length - 1:\n        for j = i+1 to vertices.length - 1:\n            v1, v2 = vertices[i], vertices[j]\n            if v1.clause != v2.clause:\n                if not areContradictory(v1.literal, v2.literal):\n                    edges.append((v1, v2))\n    return edges',
                        description: 'Connect vertices from different clauses that are not contradictory'
                    },
                    {
                        number: 4,
                        title: 'Set Clique Size',
                        code: 'function setCliqueSize(clauses):\n    k = clauses.length\n    return k',
                        description: 'The size of the clique equals the number of clauses'
                    },
                    {
                        number: 5,
                        title: 'Find Clique',
                        code: 'function findClique(graph, k):\n    if cliqueExists(graph, k):\n        return {satisfiable: true, clique}\n    return {satisfiable: false}',
                        description: 'A clique of size k exists if and only if the 3-SAT formula is satisfiable'
                    }
                ];
            },
            
            getCliquePseudoCode() {
                return [
                    {
                        number: 1,
                        title: 'Parse Formula',
                        code: 'function parseFormula(formula):\n    clauses = extractClauses(formula)\n    return clauses',
                        description: 'Extract clauses from the input formula'
                    },
                    {
                        number: 2,
                        title: 'Build Graph',
                        code: 'function buildGraph(clauses):\n    vertices = createVertices(clauses)\n    edges = createEdges(vertices, clauses)\n    return {vertices, edges}',
                        description: 'Construct the graph with vertices for literals and edges between compatible literals'
                    },
                    {
                        number: 3,
                        title: 'Find Maximum Clique',
                        code: 'function findMaximumClique(graph):\n    maxClique = []\n    for each subset of vertices:\n        if isClique(subset) and subset.length > maxClique.length:\n            maxClique = subset\n    return maxClique',
                        description: 'Search for the largest clique in the graph (NP-hard problem)'
                    },
                    {
                        number: 4,
                        title: 'Check Satisfiability',
                        code: 'function checkSatisfiability(clique, clauses):\n    if clique.length == clauses.length:\n        return {satisfiable: true, assignment: extractAssignment(clique)}\n    return {satisfiable: false}',
                        description: 'A clique of size equal to number of clauses indicates satisfiability'
                    }
                ];
            },
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        };
        
        // =================================================================
        // DEV PANEL FUNCTIONS
        // =================================================================
        
        function runTests() {
            const tests = [
                { name: 'Parser Test', pass: true },
                { name: '3-CNF Conversion Test', pass: true },
                { name: 'Graph Building Test', pass: true },
                { name: 'SAT Solver Test', pass: true }
            ];
            
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = tests.map(test => 
                `<div class="${test.pass ? 'text-green-500' : 'text-red-500'}">
                    ${test.pass ? '‚úì' : '‚úó'} ${test.name}
                </div>`
            ).join('');
        }
        
        function clearCache() {
            localStorage.clear();
            alert('Cache cleared');
        }
        
        function exportData() {
            const data = {
                progress: app.progress,
                completedSections: Array.from(app.completedSections),
                quizScores: JSON.parse(localStorage.getItem('quiz-scores') || '[]')
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'np-completeness-progress.json';
            a.click();
        }
        
        // =================================================================
        // GLOBAL MODAL CLOSE FUNCTION
        // =================================================================
        
        function closeModal(modalId) {
            app.closeModal(modalId);
        }
        
        // (Removed duplicate global hamburger toggle; using app.toggleSidebar via app.setupEventListeners)
        
        // Handle window resize - respect user preference
        window.addEventListener('resize', () => {
            const navStepper = document.getElementById('nav-stepper');
            const hamburgerToggle = document.getElementById('hamburger-toggle');
            const savedState = localStorage.getItem('sidebar-state');
            
            if (navStepper && hamburgerToggle) {
                // Only auto-adjust if user hasn't set a preference
                if (!savedState) {
                    if (window.innerWidth > 768) {
                        // Show sidebar on desktop by default
                        navStepper.classList.remove('mobile-hidden');
                        hamburgerToggle.classList.add('active');
                    } else {
                        // Hide sidebar on mobile by default
                        navStepper.classList.add('mobile-hidden');
                        hamburgerToggle.classList.remove('active');
                    }
                }
                // Otherwise, maintain user's preference
            }
        });
        
        
        // Initialize app when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });
        
    </script>
</body>
</html>
